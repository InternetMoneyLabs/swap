var Pr=Object.defineProperty;var Br=(s,e,r)=>e in s?Pr(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r;var L=(s,e,r)=>Br(s,typeof e!="symbol"?e+"":e,r);import{r as p,a as Er,R as $r,b as Tr}from"./vendor-Gm9i_4Ku.js";import{b as Lr}from"./bitcoin-DG-Uutyh.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var Dt={exports:{}},Fe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Or=p,Ir=Symbol.for("react.element"),Mr=Symbol.for("react.fragment"),Ur=Object.prototype.hasOwnProperty,_r=Or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qr={key:!0,ref:!0,__self:!0,__source:!0};function Wt(s,e,r){var n,a={},o=null,i=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)Ur.call(e,n)&&!qr.hasOwnProperty(n)&&(a[n]=e[n]);if(s&&s.defaultProps)for(n in e=s.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:Ir,type:s,key:o,ref:i,props:a,_owner:_r.current}}Fe.Fragment=Mr;Fe.jsx=Wt;Fe.jsxs=Wt;Dt.exports=Fe;var t=Dt.exports,ze={},mt=Er;ze.createRoot=mt.createRoot,ze.hydrateRoot=mt.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ne(){return Ne=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Ne.apply(this,arguments)}var G;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(G||(G={}));const ft="popstate";function Dr(s){s===void 0&&(s={});function e(n,a){let{pathname:o,search:i,hash:l}=n.location;return He("",{pathname:o,search:i,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Ht(a)}return zr(e,r,null,s)}function z(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function zt(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");}}}function Wr(){return Math.random().toString(36).substr(2,8)}function pt(s,e){return{usr:s.state,key:s.key,idx:e}}function He(s,e,r,n){return r===void 0&&(r=null),Ne({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof e=="string"?Pe(e):e,{state:r,key:e&&e.key||n||Wr()})}function Ht(s){let{pathname:e="/",search:r="",hash:n=""}=s;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Pe(s){let e={};if(s){let r=s.indexOf("#");r>=0&&(e.hash=s.substr(r),s=s.substr(0,r));let n=s.indexOf("?");n>=0&&(e.search=s.substr(n),s=s.substr(0,n)),s&&(e.pathname=s)}return e}function zr(s,e,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:o=!1}=n,i=a.history,l=G.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(Ne({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function h(){l=G.Pop;let x=d(),A=x==null?null:x-u;u=x,c&&c({action:l,location:m.location,delta:A})}function g(x,A){l=G.Push;let F=He(m.location,x,A);u=d()+1;let j=pt(F,u),N=m.createHref(F);try{i.pushState(j,"",N)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;a.location.assign(N)}o&&c&&c({action:l,location:m.location,delta:1})}function v(x,A){l=G.Replace;let F=He(m.location,x,A);u=d();let j=pt(F,u),N=m.createHref(F);i.replaceState(j,"",N),o&&c&&c({action:l,location:m.location,delta:0})}function y(x){let A=a.location.origin!=="null"?a.location.origin:a.location.href,F=typeof x=="string"?x:Ht(x);return F=F.replace(/ $/,"%20"),z(A,"No window.location.(origin|href) available to create URL for href: "+F),new URL(F,A)}let m={get action(){return l},get location(){return s(a,i)},listen(x){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(ft,h),c=x,()=>{a.removeEventListener(ft,h),c=null}},createHref(x){return e(a,x)},createURL:y,encodeLocation(x){let A=y(x);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:g,replace:v,go(x){return i.go(x)}};return m}var gt;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(gt||(gt={}));function Hr(s,e,r){return r===void 0&&(r="/"),Vr(s,e,r)}function Vr(s,e,r,n){let a=typeof e=="string"?Pe(e):e,o=Jt(a.pathname||"/",r);if(o==null)return null;let i=Vt(s);Kr(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let u=as(o);l=rs(i[c],u)}return l}function Vt(s,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(o,i,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(z(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=le([n,c.relativePath]),d=r.concat(c);o.children&&o.children.length>0&&(z(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Vt(o.children,e,d,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:es(u,o.index),routesMeta:d})};return s.forEach((o,i)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))a(o,i);else for(let c of Kt(o.path))a(o,i,c)}),e}function Kt(s){let e=s.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let i=Kt(n.join("/")),l=[];return l.push(...i.map(c=>c===""?o:[o,c].join("/"))),a&&l.push(...i),l.map(c=>s.startsWith("/")&&c===""?"/":c)}function Kr(s){s.sort((e,r)=>e.score!==r.score?r.score-e.score:ts(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Jr=/^:[\w-]+$/,Xr=3,Yr=2,Gr=1,Qr=10,Zr=-2,xt=s=>s==="*";function es(s,e){let r=s.split("/"),n=r.length;return r.some(xt)&&(n+=Zr),e&&(n+=Yr),r.filter(a=>!xt(a)).reduce((a,o)=>a+(Jr.test(o)?Xr:o===""?Gr:Qr),n)}function ts(s,e){return s.length===e.length&&s.slice(0,-1).every((n,a)=>n===e[a])?s[s.length-1]-e[e.length-1]:0}function rs(s,e,r){let{routesMeta:n}=s,a={},o="/",i=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=o==="/"?e:e.slice(o.length)||"/",h=ss({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),g=c.route;if(!h)return null;Object.assign(a,h.params),i.push({params:a,pathname:le([o,h.pathname]),pathnameBase:os(le([o,h.pathnameBase])),route:g}),h.pathnameBase!=="/"&&(o=le([o,h.pathnameBase]))}return i}function ss(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[r,n]=ns(s.path,s.caseSensitive,s.end),a=e.match(r);if(!a)return null;let o=a[0],i=o.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,d,h)=>{let{paramName:g,isOptional:v}=d;if(g==="*"){let m=l[h]||"";i=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const y=l[h];return v&&!y?u[g]=void 0:u[g]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:s}}function ns(s,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),zt(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let n=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function as(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zt(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),s}}function Jt(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=s.charAt(r);return n&&n!=="/"?null:s.slice(r)||"/"}const le=s=>s.join("/").replace(/\/\/+/g,"/"),os=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/");function is(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const Xt=["post","put","patch","delete"];new Set(Xt);const ls=["get",...Xt];new Set(ls);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Se(){return Se=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Se.apply(this,arguments)}const cs=p.createContext(null),ds=p.createContext(null),Yt=p.createContext(null),Be=p.createContext(null),Ee=p.createContext({outlet:null,matches:[],isDataRoute:!1}),Gt=p.createContext(null);function ot(){return p.useContext(Be)!=null}function us(){return ot()||z(!1),p.useContext(Be).location}function hs(s,e){return ms(s,e)}function ms(s,e,r,n){ot()||z(!1);let{navigator:a}=p.useContext(Yt),{matches:o}=p.useContext(Ee),i=o[o.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=us(),d;if(e){var h;let x=typeof e=="string"?Pe(e):e;c==="/"||(h=x.pathname)!=null&&h.startsWith(c)||z(!1),d=x}else d=u;let g=d.pathname||"/",v=g;if(c!=="/"){let x=c.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(x.length).join("/")}let y=Hr(s,{pathname:v}),m=ys(y&&y.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:le([c,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:le([c,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),o,r,n);return e&&m?p.createElement(Be.Provider,{value:{location:Se({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:G.Pop}},m):m}function fs(){let s=ks(),e=is(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),r=s instanceof Error?s.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),r?p.createElement("pre",{style:a},r):null,null)}const ps=p.createElement(fs,null);console.log("[TRACE] constructor in index-DJ07tDoB.js");e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?p.createElement(Ee.Provider,{value:this.props.routeContext},p.createElement(Gt.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function xs(s){let{routeContext:e,match:r,children:n}=s,a=p.useContext(cs);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),p.createElement(Ee.Provider,{value:e},n)}function ys(s,e,r,n){var a;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),s==null){var o;if(!r)return null;if(r.errors)s=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)s=r.matches;else return null}let i=s,l=(a=r)==null?void 0:a.errors;if(l!=null){let d=i.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||z(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:g,errors:v}=r,y=h.route.loader&&g[h.route.id]===void 0&&(!v||v[h.route.id]===void 0);if(h.route.lazy||y){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,h,g)=>{let v,y=!1,m=null,x=null;r&&(v=l&&h.route.id?l[h.route.id]:void 0,m=h.route.errorElement||ps,c&&(u<0&&g===0?(js("route-fallback"),y=!0,x=null):u===g&&(y=!0,x=h.route.hydrateFallbackElement||null)));let A=e.concat(i.slice(0,g+1)),F=()=>{let j;return v?j=m:y?j=x:h.route.Component?j=p.createElement(h.route.Component,null):h.route.element?j=h.route.element:j=d,p.createElement(xs,{match:h,routeContext:{outlet:d,matches:A,isDataRoute:r!=null},children:j})};return r&&(h.route.ErrorBoundary||h.route.errorElement||g===0)?p.createElement(gs,{location:r.location,revalidation:r.revalidation,component:m,error:v,children:F(),routeContext:{outlet:null,matches:A,isDataRoute:!0}}):F()},null)}var Qt=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(Qt||{});function bs(s){let e=p.useContext(ds);return e||z(!1),e}function ws(s){let e=p.useContext(Ee);return e||z(!1),e}function vs(s){let e=ws(),r=e.matches[e.matches.length-1];return r.route.id||z(!1),r.route.id}function ks(){var s;let e=p.useContext(Gt),r=bs(Qt.UseRouteError),n=vs();return e!==void 0?e:(s=r.errors)==null?void 0:s[n]}const yt={};function js(s,e,r){yt[s]||(yt[s]=!0)}function Ns(s,e){s==null||s.v7_startTransition,s==null||s.v7_relativeSplatPath}function fe(s){z(!1)}function Ss(s){let{basename:e="/",children:r=null,location:n,navigationType:a=G.Pop,navigator:o,static:i=!1,future:l}=s;ot()&&z(!1);let c=e.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:c,navigator:o,static:i,future:Se({v7_relativeSplatPath:!1},l)}),[c,l,o,i]);typeof n=="string"&&(n=Pe(n));let{pathname:d="/",search:h="",hash:g="",state:v=null,key:y="default"}=n,m=p.useMemo(()=>{let x=Jt(d,c);return x==null?null:{location:{pathname:x,search:h,hash:g,state:v,key:y},navigationType:a}},[c,d,h,g,v,y,a]);return m==null?null:p.createElement(Yt.Provider,{value:u},p.createElement(Be.Provider,{children:r,value:m}))}function Cs(s){let{children:e,location:r}=s;return hs(Ve(e),r)}new Promise(()=>{});function Ve(s,e){e===void 0&&(e=[]);let r=[];return p.Children.forEach(s,(n,a)=>{if(!p.isValidElement(n))return;let o=[...e,a];if(n.type===p.Fragment){r.push.apply(r,Ve(n.props.children,o));return}n.type!==fe&&z(!1),!n.props.index||!n.props.children||z(!1);let i={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Ve(n.props.children,o)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const As="6";try{window.__reactRouterVersion=As}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");}const Rs="startTransition",bt=$r[Rs];function Fs(s){let{basename:e,children:r,future:n,window:a}=s,o=p.useRef();o.current==null&&(o.current=Dr({window:a,v5Compat:!0}));let i=o.current,[l,c]=p.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=p.useCallback(h=>{u&&bt?bt(()=>c(h)):c(h)},[c,u]);return p.useLayoutEffect(()=>i.listen(d),[i,d]),p.useEffect(()=>Ns(n),[n]),p.createElement(Ss,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:i,future:n})}var wt;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(wt||(wt={}));var vt;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(vt||(vt={}));const Zt=p.createContext(void 0),er=()=>{const s=p.useContext(Zt);if(!s)throw new Error("useTheme must be used within a ThemeProvider");return s},Ps=({children:s})=>{const[e,r]=p.useState("light");p.console.log("[TRACE] useEffect in index-DJ07tDoB.js");const o=localStorage.getItem("fractal-swap-theme"),i=window.matchMedia("(prefers-color-scheme: dark)").matches;o?r(o):i&&r("dark")},[]),p.useEffect(()=>{const o=window.document.documentElement;o.classList.remove("light","dark"),o.classList.add(e),localStorage.setItem("fractal-swap-theme",e)},[e]);const a={theme:e,toggleTheme:()=>{r(o=>o==="light"?"dark":"light")}};return t.jsx(Zt.Provider,{value:a,children:s})},tr=p.createContext(void 0),it=()=>{const s=p.useContext(tr);if(!s)throw new Error("useNetwork must be used within a NetworkProvider");return s},he=[{name:"Fractal Bitcoin Testnet",type:"fractal_testnet",apiBase:"https://open-api-fractal.unisat.io",swapApi:"https://api-proxy.ddpurse.com",explorer:"https://explorer-fractal-testnet.unisat.io"},{name:"Fractal Bitcoin Mainnet",type:"fractal_mainnet",apiBase:"https://open-api-fractal.unisat.io",swapApi:"https://api-proxy.ddpurse.com",explorer:"https://explorer-fractal.unisat.io"}],Bs=({children:s})=>{const[e,r]=p.useState(he[0]),[n,a]=p.useState(null),[o,i]=p.useState([]);p.useEffect(()=>{const g="fractal_mainnet",v=he.find(y=>y.type===g)||he[0];r(v),l()},[]);const l=async()=>{const g=[{id:"layer-1",name:"Base Layer",level:1,status:"active",blockHeight:15e4,anchored:!0,congestion:"low",feeRate:1},{id:"layer-2.1",name:"Layer 2.1",level:2,status:"active",blockHeight:149950,anchored:!0,congestion:"medium",feeRate:2},{id:"layer-2.2",name:"Layer 2.2",level:2,status:"syncing",blockHeight:149900,anchored:!1,congestion:"high",feeRate:5}];i(g),a(g[0])},h={currentNetwork:e,availableNetworks:he,currentLayer:n,availableLayers:o,switchNetwork:g=>{const v=he.find(y=>y.type===g);v&&(r(v),l())},switchLayer:g=>{const v=o.find(y=>y.id===g);v&&a(v)},refreshLayers:async()=>{await l()}};return t.jsx(tr.Provider,{value:h,children:s})},ee=class ee{constructor(){L(this,"baseUrl");L(this,"network");L(this,"runesCache",new Map);L(this,"marketDataCache",new Map);L(this,"lastUpdate",new Map);L(this,"cacheTimeout",3e4);this.network="mainnet",this.baseUrl=this.network==="mainnet"?"https://open-api-fractal.unisat.io":"https://open-api-fractal-testnet.unisat.io"}static getInstance(){return ee.instance||(ee.instance=new ee),ee.instance}console.log("[TRACE] async method in index-DJ07tDoB.js");try{const r=`balances_${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`,n=this.lastUpdate.get(r)||0;if(Date.now()-n<this.cacheTimeout&&this.runesCache.has(r))return this.runesCache.get(r);const a=await fetch(`${this.baseUrl}/v1/indexer/address/${e}/runes/balance-list`,{headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const o=await a.json();if(o.code!==0)throw new Error(`API Error: ${o.msg}`);const i=o.data.detail||[];return this.runesCache.set(r,i),this.lastUpdate.set(r,Date.now()),console.log(`Fetched ${i.length} Runes balances for ${e}`),i}catch(r){console.error("Failed to fetch Runes balances:",r);const n=`balances_${e}`;return this.runesCache.has(n)?(console.warn("Returning stale cached data due to API error"),this.runesCache.get(n)):[]}}async getRuneInfo(e){try{const r=await fetch(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/v1/indexer/runes/${e}/info`,{headers:{Accept:"application/json"}});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const n=await r.json();if(n.code!==0)throw new Error(`API Error: ${n.msg}`);return n.data}catch(r){return console.error(`Failed to fetch Rune info for ${e}:`,r),null}}async getRuneMarketData(e){try{const r=`market_${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`,n=this.lastUpdate.get(r)||0;if(Date.now()-n<this.cacheTimeout&&this.marketDataCache.has(r))return this.marketDataCache.get(r);const a=await fetch(`${this.baseUrl}/v1/indexer/runes/${e}/market`,{headers:{Accept:"application/json"}});let o;if(a.ok){const i=await a.json();if(i.code===0)o=i.data;else{const l=await this.getRuneInfo(e);o={rune:(l==null?void 0:l.rune)||e,runeid:e,holders:(l==null?void 0:l.holders)||0}}}else{const i=await this.getRuneInfo(e);o={rune:(i==null?void 0:i.rune)||e,runeid:e,holders:(i==null?void 0:i.holders)||0}}return this.marketDataCache.set(r,o),this.lastUpdate.set(r,Date.now()),o}catch(r){return console.error(`Failed to fetch market data for ${e}:`,r),null}}async getAllRunes(e=100,r=0){try{const n=await fetch(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/v1/indexer/runes/list?limit=${e}&offset=${r}`,{headers:{Accept:"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const a=await n.json();if(a.code!==0)throw new Error(`API Error: ${a.msg}`);return a.data.detail||[]}catch(n){return console.error("Failed to fetch all Runes:",n),[]}}formatRuneAmount(e,r){const n=BigInt(e),a=BigInt(10**r);if(r===0)return n.toString();const o=n/a,i=n%a;if(i===0n)return o.toString();const c=i.toString().padStart(r,"0").replace(/0+$/,"");return`${o}.${c}`}parseRuneAmount(e,r){if(r===0)return e;const[n="0",a=""]=e.split("."),o=a.padEnd(r,"0").slice(0,r),i=BigInt(n)*BigInt(10**r),l=BigInt(o);return(i+l).toString()}getFormattedBalance(e){return this.formatRuneAmount(e.amount,e.divisibility)}clearBalanceCache(e){const r=`balances_${e}`;this.runesCache.delete(r),this.lastUpdate.delete(r)}clearAllCaches(){this.runesCache.clear(),this.marketDataCache.clear(),this.lastUpdate.clear()}getNetworkInfo(){return{network:this.network,baseUrl:this.baseUrl}}};L(ee,"instance");let Ce=ee;class Es{constructor(){L(this,"currentWallet",null);L(this,"requiredNetwork","fractal_mainnet")}async getAvailableWallets(){const e=[];return typeof window.unisat<"u"?e.push({name:"UniSat",icon:"/icons/unisat.png",installed:!0,connector:window.unisat}):e.push({name:"UniSat",icon:"/icons/unisat.png",installed:!1,connector:null}),typeof window.okxwallet<"u"?e.push({name:"OKX",icon:"/icons/okx.png",installed:!0,connector:window.okxwallet}):e.push({name:"OKX",icon:"/icons/okx.png",installed:!1,connector:null}),e}async connect(e){let r;switch(e.toLowerCase()){case"unisat":if(!window.unisat)throw new Error("UniSat wallet not installed");r=window.unisat;break;case"okx":if(!window.okxwallet)throw new Error("OKX wallet not installed");r=window.okxwallet;break;default:throw new Error(`Unsupported wallet: ${e}`)}try{console.log(`🔗 Connecting to ${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);} wallet...`);try{await this.checkAndSwitchNetwork(r,e)}catch(l){console.warn("Network check failed, but proceeding with connection:",l.message)}const n=await r.requestAccounts();if(!n||n.length===0)throw new Error("No accounts found");const a=n[0];let o="";try{o=await r.getPublicKey()}catch(l){console.warn("Could not get public key:",l)}const i=await this.getWalletBalance(r,a);return this.currentWallet=e.toLowerCase(),console.log(`✅ Successfully connected to ${e}`),console.log(`Address: ${a}`),console.log(`Balance: ${i}`),{address:a,publicKey:o,balance:i}}catch(n){throw console.error("Wallet connection failed:",n),new Error(`Failed to connect to ${e}: ${n.message}`)}}async checkAndSwitchNetwork(e,r){try{console.log(`🔍 Checking network for ${r}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}...`),console.log(`Required network: ${this.requiredNetwork}`);let n=null;try{if(e.getNetwork?(n=await e.getNetwork(),console.log("wallet.getNetwork() returned:",n)):e.getChain?(n=await e.getChain(),console.log("wallet.getChain() returned:",n)):console.log("Wallet has no getNetwork() or getChain() method"),r.toLowerCase()==="unisat")try{if(e.getChainType){const a=await e.getChainType();console.log("UniSat getChainType():",a)}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}if(e.getBitcoinNetwork){const a=await e.getBitcoinNetwork();console.log("UniSat getBitcoinNetwork():",a)}}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");console.log("UniSat-specific network methods not available")}}catch(a){console.warn("Could not detect current network:",a),console.log("⚠️ Network detection failed, proceeding with connection...");return}if(this.requiredNetwork==="fractal_mainnet"){const a=this.isOnBitcoinMainnet(n);if(a){console.log("✅ Wallet is on Bitcoin mainnet (compatible with Fractal Bitcoin)");return}const o=this.isOnTestnet(n);if(o)throw console.log("❌ Wallet is on testnet, but we need mainnet"),new Error(`Please switch your ${r} wallet from testnet to mainnet`);console.log("⚠️ Could not clearly determine network, proceeding with connection..."),console.log("Network detection result - mainnet:",a,"testnet:",o);return}}catch(n){if(console.error("Network check failed:",n),n.message.includes("testnet")||n.message.includes("switch"))throw n;console.log("⚠️ Network check inconclusive, proceeding with connection...")}}isOnBitcoinMainnet(e){return e?[e==="livenet",e==="mainnet",e.network==="livenet",e.network==="mainnet",e.chainId==="bitcoin-mainnet",e.name==="Bitcoin Mainnet",e==="BITCOIN_MAINNET",e.type==="mainnet"].some(n=>n===!0):!1}isOnTestnet(e){return e?[e==="testnet",e.network==="testnet",e.chainId==="bitcoin-testnet",e.name==="Bitcoin Testnet",e==="BITCOIN_TESTNET",e.type==="testnet",e==="fractal-testnet",e.chainId==="fractal-testnet"].some(n=>n===!0):!1}isCorrectNetwork(e,r){return e?[e.chainId===r.chainId,e.network===r.chainId,e.name===r.networkName,e===r.chainId].some(a=>a===!0):!1}async requestNetworkSwitch(e,r,n){try{if(r.toLowerCase()==="unisat")await this.switchUnisatNetwork(e,n);else if(r.toLowerCase()==="okx")await this.switchOKXNetwork(e,n);else throw new Error("Network switching not supported for this wallet");console.log(`✅ Successfully switched to ${n.networkName}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`)}catch(a){throw console.error("Network switch failed:",a),new Error(`Failed to switch to ${n.networkName}. Please switch manually in your wallet.`)}}async switchUnisatNetwork(e,r){if(e.switchNetwork)await e.switchNetwork(r.chainId);else if(e.switchChain)await e.switchChain(r.chainId);else throw new Error(`Please manually switch UniSat to ${r.networkName}`)}async switchOKXNetwork(e,r){if(e.bitcoin&&e.bitcoin.switchNetwork)await e.bitcoin.switchNetwork(r.chainId);else throw new Error(`Please manually switch OKX to ${r.networkName}`)}async getCurrentNetwork(){const e=this.getCurrentWallet();if(!e)return null;try{let r=null;return e.getNetwork?r=await e.getNetwork():e.getChain&&(r=await e.getChain()),r?this.isOnBitcoinMainnet(r)?"bitcoin-mainnet":this.isOnTestnet(r)?"bitcoin-testnet":typeof r=="string"?r:JSON.stringify(r):null}catch(r){return console.warn("Could not get current network:",r),null}}async getRunesBalances(e){try{console.log(`🔍 Fetching live Runes balances for address: ${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);const r=Ce.getInstance(),n=await r.getRunesBalances(e),a={};return n.forEach(o=>{const i=r.getFormattedBalance(o),l=parseFloat(i);o.runeid&&(a[o.runeid]=l),o.spacedRune&&(a[o.spacedRune]=l),o.symbol&&o.symbol!==o.spacedRune&&(a[o.symbol]=l),console.log(`✅ Live Rune: ${o.spacedRune} (${o.runeid}) - Balance: ${i} ${o.symbol||""}`)}),console.log(`📊 Total Runes found: ${n.length}`),a}catch(r){return console.error("❌ Failed to fetch live Runes balances:",r),{}}}async getRuneBalance(e,r){try{return(await this.getRunesBalances(e))[r]||0}catch(n){return console.error(`Failed to get balance for rune ${r}:`,n),0}}async debugRunesBalanceAPI(e){const r="https://open-api-fractal.unisat.io";console.log("🔧 DEBUG: Testing Runes balance API endpoints..."),console.log("Address:",e),console.log("API Base:",r);const n=[`/v1/indexer/address/${e}/runes/balance-list`,`/v1/indexer/address/${e}/runes`,`/v1/indexer/address/${e}/balance-list`,`/v1/indexer/runes/address/${e}/balance`,`/v1/indexer/runes/balance/${e}`,`/v1/indexer/address/${e}/runes-balance`,`/v1/indexer/address/${e}/assets`,`/v1/indexer/address/${e}/tokens`];for(const a of n)try{console.log(`
🔍 Testing: ${r}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}${a}`);const o=await fetch(`${r}${a}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(console.log(`Status: ${o.status} ${o.statusText}`),o.ok){const i=await o.json();if(console.log("✅ SUCCESS - Response structure:",{code:i.code,message:i.message,dataKeys:i.data?Object.keys(i.data):"no data",dataType:typeof i.data,sampleData:i.data}),i.data){const l=i.data.detail||i.data.list||i.data;if(Array.isArray(l)){console.log(`Found ${l.length} items in response`);const c=l.find(u=>{const d=u.spacedRune||u.rune||u.name||u.tick||"";return d.toLowerCase().includes("black")&&d.toLowerCase().includes("myth")});c?console.log("🎯 FOUND black•myth•sun•wu•kong:",c):console.log("Sample items:",l.slice(0,3))}}}else{const i=await o.text();console.log("❌ FAILED - Error:",i)}}catch(o){console.log("❌ FAILED - Exception:",o.message)}try{console.log(`
🔍 Testing general address info: ${r}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/v1/indexer/address/${e}`);const a=await fetch(`${r}/v1/indexer/address/${e}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(a.ok){const o=await a.json();console.log("✅ Address info:",o)}}catch(a){console.log("❌ Address info failed:",a.message)}}async disconnect(){this.currentWallet=null}async isConnected(){if(!this.currentWallet)return!1;try{const e=this.getCurrentWallet();if(!e)return!1;const r=await e.getAccounts();return r&&r.length>0}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");return!1}}async getAccount(){const e=this.getCurrentWallet();if(!e)throw new Error("No wallet connected");const r=await e.getAccounts();if(!r||r.length===0)throw new Error("No accounts found");const n=r[0];let a="";try{a=await e.getPublicKey()}catch(i){console.warn("Could not get public key:",i)}const o=await this.getWalletBalance(e,n);return{address:n,publicKey:a,balance:o}}async getBalance(){const e=this.getCurrentWallet();if(!e)throw new Error("No wallet connected");const r=await e.getAccounts();if(!r||r.length===0)throw new Error("No accounts found");return await this.getWalletBalance(e,r[0])}async signPSBT(e){const r=this.getCurrentWallet();if(!r)throw new Error("No wallet connected");try{return await r.signPsbt(e)}catch(n){throw console.error("PSBT signing failed:",n),new Error(`Failed to sign transaction: ${n}`)}}getCurrentWallet(){if(!this.currentWallet)return null;switch(this.currentWallet){case"unisat":return window.unisat;case"okx":return window.okxwallet;default:return null}}async getWalletBalance(e,r){try{return this.requiredNetwork==="fractal_mainnet"?await this.getFractalBitcoinBalance(r):(await e.getBalance()).confirmed||0}catch(n){return console.warn("Could not get balance:",n),0}}async getFractalBitcoinBalance(e){try{const r="https://open-api-fractal.unisat.io";console.log(`🔍 Fetching FB balance for address: ${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);const n=await fetch(`${r}/v1/indexer/address/${e}/balance`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!n.ok)throw new Error(`Balance API failed: ${n.status}`);const a=await n.json();if(console.log("Fractal Bitcoin balance response:",a),a.code===0&&a.data){const o=a.data.satoshi||a.data.confirmed||0,i=o/1e8;return console.log(`✅ FB Balance: ${i} FB (${o} satoshis)`),i}return console.warn("Unexpected balance response format:",a),0}catch(r){console.error("Failed to fetch Fractal Bitcoin balance:",r);try{const n=this.getCurrentWallet();if(n){const a=await n.getBalance();return console.warn("⚠️ Using wallet balance (might be BTC, not FB):",a),a.confirmed||0}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}}catch(n){console.error("Fallback balance fetch also failed:",n)}return 0}}formatAddress(e,r=8){return e?e.length<=r*2?e:`${e.slice(0,r)}...${e.slice(-r)}`:""}isValidBitcoinAddress(e){return[/^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$/,/^3[a-km-zA-HJ-NP-Z1-9]{25,34}$/,/^bc1[a-z0-9]{39,59}$/,/^tb1[a-z0-9]{39,59}$/,/^fb1[a-z0-9]{39,59}$/].some(n=>n.test(e))}getNetworkDisplayName(){return this.requiredNetwork==="fractal_mainnet"?"Fractal Bitcoin Mainnet":"Fractal Bitcoin Testnet"}}const H=new Es,$s=Object.freeze(Object.defineProperty({__proto__:null,walletService:H},Symbol.toStringTag,{value:"Module"})),rr=p.createContext(void 0),oe=()=>{const s=p.useContext(rr);if(!s)throw new Error("useWallet must be used within a WalletProvider");return s},Ts=({children:s})=>{const[e,r]=p.useState(null),[n,a]=p.useState(!1),[o,i]=p.useState([]),[l,c]=p.useState(null),[u,d]=p.useState({}),h=H.getNetworkDisplayName();p.useEffect(()=>{(async()=>{try{const N=new Promise((P,E)=>{setTimeout(()=>E(new Error("Wallet initialization timeout")),2e3)}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}),k=async()=>{const P=await H.getAvailableWallets();if(i(P),await H.isConnected()){const w=await H.getAccount();r(w);const C=await H.getCurrentNetwork();c(C)}};await Promise.race([k(),N])}catch(N){console.warn("Wallet initialization failed or timed out:",N),i([{name:"UniSat",icon:"/icons/unisat.png",installed:typeof window<"u"&&!!window.unisat,connector:typeof window<"u"?window.unisat:null},{name:"OKX",icon:"/icons/okx.png",installed:typeof window<"u"&&!!window.okxwallet,connector:typeof window<"u"?window.okxwallet:null}])}})()},[]);const g=async j=>{a(!0);try{const N=await H.connect(j);r(N);const k=await H.getCurrentNetwork();c(k),await y(N.address)}catch(N){throw console.error("Failed to connect wallet:",N),N}finally{a(!1)}},v=()=>{H.disconnect(),r(null),c(null),d({})},y=async j=>{try{const N=j||(e==null?void 0:e.address);if(!N){console.log("❌ No address available for refreshing runes balances");return}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}console.log("🔄 Refreshing Runes balances for address:",N);const k=await H.getRunesBalances(N);d(k),console.log("✅ Refreshed Runes balances:",k)}catch(N){console.error("❌ Failed to refresh Runes balances:",N)}},F={account:e,isConnected:!!e,isConnecting:n,availableWallets:o,currentNetwork:l,requiredNetwork:h,runesBalances:u,connect:g,disconnect:v,signPSBT:async j=>{if(!e)throw new Error("No wallet connected");return await H.signPSBT(j)},getBalance:async()=>{if(!e)throw new Error("No wallet connected");return await H.getBalance()},refreshNetwork:async()=>{try{const j=await H.getCurrentNetwork();c(j)}catch(j){console.error("Failed to refresh network:",j)}},refreshRunesBalances:y};return t.jsx(rr.Provider,{value:F,children:s})},sr=p.createContext(void 0),Ls=()=>{const s=p.useContext(sr);if(!s)throw new Error("useNotifications must be used within a NotificationProvider");return s},Os=({children:s})=>{const[e,r]=p.useState([]),n=h=>{const g=`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,v={...h,id:g,autoClose:h.autoClose!==!1,duration:h.duration||5e3};r(y=>[...y,v])},d={notifications:e,addNotification:n,removeNotification:h=>{r(g=>g.filter(v=>v.id!==h))},clearAllNotifications:()=>{r([])},showSuccess:(h,g,v=5e3)=>{n({type:"success",title:h,message:g,duration:v})},showError:(h,g,v=7e3)=>{n({type:"error",title:h,message:g,duration:v})},showInfo:(h,g,v=5e3)=>{n({type:"info",title:h,message:g,duration:v})},showWarning:(h,g,v=6e3)=>{n({type:"warning",title:h,message:g,duration:v})}};return t.jsx(sr.Provider,{value:d,children:s})};class kt extends p.Component{constructor(){super(...arguments);L(this,"state",{hasError:!1})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){var a,o;console.error("ErrorBoundary caught an error:",r,n),(o=(a=this.props).onError)==null||o.call(a,r,n)}render(){var r;return this.state.hasError?this.props.fallback?this.props.fallback:t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 dark:bg-red-900/20",children:t.jsx("div",{className:"max-w-md w-full mx-4",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border border-red-200 dark:border-red-800",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[t.jsx("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-200",children:"Component Error"}),t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:"Something went wrong with this component"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 rounded border border-red-200 dark:border-red-800",children:t.jsx("p",{className:"text-sm text-red-700 dark:text-red-300 font-mono",children:((r=this.state.error)==null?void 0:r.message)||"Unknown error occurred"})}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:()=>window.location.reload(),className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Reload Page"}),t.jsx("button",{onClick:()=>this.setState({hasError:!1,error:void 0}),className:"flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-gray-700 transition-colors",children:"Try Again"})]}),t.jsx("div",{className:"text-center",children:t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"If this persists, please contact support"})})]})]})})}):this.props.children}}const te=class te{constructor(){L(this,"securityAlerts",[]);L(this,"trustedDomains",new Set(["localhost","127.0.0.1"]));L(this,"sessionStartTime",Date.now())}static getInstance(){return te.instance||(te.instance=new te),te.instance}validatePSBT(e,r,n){const a={isValid:!0,risks:[],warnings:[],recommendations:[]};try{if(!e||typeof e!="string")return a.isValid=!1,a.risks.push("Invalid PSBT format"),a;(e.includes("eval(")||e.includes("javascript:"))&&(a.isValid=!1,a.risks.push("PSBT contains suspicious code patterns")),e.length>1e6&&(a.isValid=!1,a.risks.push("PSBT size exceeds safety limits"));const o=(e.match(/output/gi)||[]).length;o>10&&a.warnings.push(`PSBT has ${o}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);} outputs - verify all destinations`),r&&r>1&&a.warnings.push("Large transaction amount - please verify carefully"),a.recommendations.push("Verify transaction details in your wallet before signing"),a.recommendations.push("Never sign PSBTs from untrusted sources"),a.recommendations.push("Check all output addresses match your expectations")}catch(o){a.isValid=!1,a.risks.push(`PSBT validation error: ${o.message}`)}return a}monitorWalletActivity(e){const r=Date.now();e.type==="sign"&&this.getRecentActivities("sign",6e4).length>5&&this.addSecurityAlert({type:"warning",message:"Rapid signing attempts detected - verify you initiated all transactions",timestamp:r}),e.type==="network_change"&&this.addSecurityAlert({type:"info",message:"Network changed - verify you are on the correct network",timestamp:r}),this.storeActivity(e)}validateWalletConnection(e,r){const n=[];let a=!0;if(!e||typeof e!="object")return a=!1,n.push("Wallet object is invalid or missing"),{isSecure:a,warnings:n};const o=["requestAccounts","signPsbt","getAccounts"];for(const l of o)typeof e[l]!="function"&&n.push(`Wallet missing required method: ${l}`);const i=["eval","Function"];for(const l of i)e[l]&&(n.push(`Wallet has suspicious property: ${l}`),a=!1);if(typeof window<"u"){const l=window.location.origin;this.trustedDomains.has(new URL(l).hostname)||n.push("Application not running on trusted domain")}return{isSecure:a,warnings:n}}validateSession(){const e=Date.now(),r=e-this.sessionStartTime,n=24*60*60*1e3;return r>n?(this.addSecurityAlert({type:"warning",message:"Long session detected - consider refreshing for security",timestamp:e}),!1):!0}performSecurityScan(){var n;const e=[],r=[];return typeof window<"u"&&(window.outerHeight-window.innerHeight>200||window.outerWidth-window.innerWidth>200)&&(e.push("Developer tools may be open"),r.push("Close developer tools for better security")),typeof window<"u"&&((n=window.chrome)!=null&&n.runtime)&&r.push("Be cautious of browser extensions that can access wallet data"),typeof localStorage<"u"&&Object.keys(localStorage).filter(i=>i.toLowerCase().includes("private")||i.toLowerCase().includes("seed")||i.toLowerCase().includes("mnemonic")).length>0&&(e.push("Sensitive data detected in browser storage"),r.push("Clear browser data regularly")),{threats:e,recommendations:r}}addSecurityAlert(e){const r={...e,id:`alert_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,resolved:!1};this.securityAlerts.push(r),this.securityAlerts.length>100&&(this.securityAlerts=this.securityAlerts.slice(-100)),e.type==="critical"?console.error("🚨 CRITICAL SECURITY ALERT:",e.message):e.type==="warning"&&console.warn("⚠️ SECURITY WARNING:",e.message)}getRecentActivities(e,r){return[]}storeActivity(e){console.log("Activity logged:",e.type,e.wallet)}getSecurityAlerts(){return this.securityAlerts.filter(e=>!e.resolved)}resolveAlert(e){const r=this.securityAlerts.find(n=>n.id===e);r&&(r.resolved=!0)}generateSecurityReport(){const e=this.getSecurityAlerts(),r=e.filter(l=>l.type==="critical"),n=e.filter(l=>l.type==="warning");let a="secure",o="Security status is good";r.length>0?(a="critical",o=`${r.length} critical security issue(s) detected`):n.length>0&&(a="warning",o=`${n.length} security warning(s) active`);const i=this.performSecurityScan();return{status:a,summary:o,details:{activeAlerts:e.length,sessionDuration:Date.now()-this.sessionStartTime,lastScan:Date.now(),recommendations:["Always verify transaction details before signing","Keep your wallet software updated","Never share your private keys or seed phrases","Use hardware wallets for large amounts",...i.recommendations]}}}};L(te,"instance");let Ke=te;const lt=({isOpen:s,onClose:e,title:r,children:n})=>(p.useEffect(()=>{const a=o=>{o.key==="Escape"&&e()};return s&&(document.addEventListener("keydown",a),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[s,e]),s?t.jsxs("div",{className:"modal-overlay",children:[t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:e}),t.jsx("div",{className:"relative z-50 flex min-h-full items-center justify-center p-4",children:t.jsxs("div",{className:"relative bg-white dark:bg-fractal-gray rounded-lg shadow-xl max-w-2xl w-full max-h-[85vh] overflow-hidden border border-gray-200 dark:border-gray-700",children:[r&&t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-fractal-gray sticky top-0 z-10",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r}),t.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors p-1",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),t.jsx("div",{className:"p-6 bg-white dark:bg-fractal-gray overflow-y-auto max-h-[calc(85vh-80px)]",children:n})]})})]}):null),jt=()=>{const{account:s,isConnected:e,isConnecting:r,availableWallets:n,connect:a,disconnect:o}=oe(),[i,l]=p.useState(!1),[c,u]=p.useState(null),[d,h]=p.useState(!1),[g,v]=p.useState([]),[y,m]=p.useState(!1),x=Ke.getInstance();p.useEffect(()=>{if(e&&s){const k=()=>{const E=x.generateSecurityReport();E.status!=="secure"?v(E.details.recommendations.slice(0,3)):v([])};k();const P=setInterval(k,3e4);return()=>clearInterval(P)}},[e,s]);const A=async k=>{try{u(null);const P=k==="UniSat"?window.unisat:window.okxwallet;if(P){const E=x.validateWalletConnection(P,k),w=E.warnings.filter(C=>!C.includes("constructor")&&!C.includes("trusted domain"));if(w.length>0){u(`Security validation failed: ${w.join(", ")}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);return}E.warnings.length>0&&console.warn("Wallet security warnings (non-blocking):",E.warnings)}await a(k),x.monitorWalletActivity({type:"connect",wallet:k,details:{timestamp:Date.now()}}),l(!1)}catch(P){u(P instanceof Error?P.message:"Failed to connect wallet")}},F=()=>{o()},j=async()=>{if(s!=null&&s.address)try{await navigator.clipboard.writeText(s.address),h(!0),setTimeout(()=>h(!1),2e3)}catch(k){console.error("Failed to copy address:",k)}},N=k=>k?k.length<=16?k:`${k.slice(0,8)}...${k.slice(-8)}`:"";return e&&s?t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-3",children:[t.jsxs("div",{className:"hidden md:block text-right",children:[t.jsxs("div",{className:"text-responsive-sm font-medium",children:[s.balance.toFixed(8)," FB"]}),t.jsx("div",{className:"text-responsive-xs text-gray-500 dark:text-gray-400",children:"Fractal Bitcoin"})]}),t.jsxs("button",{onClick:j,className:"fractal-card py-2 px-3 min-w-0 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors relative touch-button w-full sm:w-auto",title:"Click to copy address",children:[t.jsxs("div",{className:"flex items-center justify-between sm:justify-center space-x-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full flex-shrink-0"}),t.jsx("span",{className:"font-mono text-responsive-xs",children:N(s.address)})]}),t.jsx("div",{className:"md:hidden text-right",children:t.jsxs("div",{className:"text-responsive-xs font-medium",children:[s.balance.toFixed(4)," FB"]})})]}),d&&t.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs px-2 py-1 rounded z-10",children:"Copied!"})]}),g.length>0&&t.jsxs("button",{onClick:()=>m(!0),className:"touch-button p-2 text-yellow-500 hover:text-yellow-600 transition-colors relative",title:"Security warnings",children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),t.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-500 rounded-full"})]}),t.jsx("button",{onClick:F,className:"touch-button p-2 text-gray-500 hover:text-red-500 transition-colors",title:"Disconnect wallet",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]}):t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>l(!0),disabled:r,className:"fractal-button",children:r?t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),t.jsx("span",{children:"Connecting..."})]}):"Connect Wallet"}),t.jsx(lt,{isOpen:i,onClose:()=>l(!1),title:"Connect Wallet",children:t.jsxs("div",{className:"space-y-4",children:[c&&t.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:t.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:c})}),t.jsx("div",{className:"space-y-3",children:n.map(k=>t.jsxs("button",{onClick:()=>A(k.name),disabled:!k.installed||r,className:`w-full p-4 border rounded-lg flex items-center space-x-3 transition-all ${k.installed?"border-gray-200 dark:border-gray-700 hover:border-fractal-orange hover:bg-fractal-orange/5":"border-gray-100 dark:border-gray-800 opacity-50 cursor-not-allowed"}`,children:[t.jsx("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center border border-gray-200 dark:border-gray-700",children:k.name==="UniSat"?t.jsx("img",{src:"unisat-logo.png",alt:"UniSat Wallet",className:"w-6 h-6 object-contain"}):k.name==="OKX"?t.jsx("img",{src:"okx-logo.png",alt:"OKX Wallet",className:"w-6 h-6 object-contain"}):t.jsx("span",{className:"text-sm font-bold",children:k.name.charAt(0)})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium",children:k.name}),t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:k.installed?"Ready to connect":"Not installed"})]}),!k.installed&&t.jsx("a",{href:k.name==="UniSat"?"https://unisat.io":"https://www.okx.com/web3",target:"_blank",rel:"noopener noreferrer",className:"text-fractal-orange text-sm hover:underline",onClick:P=>P.stopPropagation(),children:"Install"})]},k.name))}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"By connecting a wallet, you agree to the Terms of Service and Privacy Policy."})]})})]})},Nt=()=>{const{currentNetwork:s,availableNetworks:e,switchNetwork:r}=it(),[n,a]=p.useState(!1),o=i=>{r(i),a(!1)};return t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>a(!0),className:"flex items-center space-x-2 px-3 py-2 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-fractal-orange transition-colors",children:[t.jsx("div",{className:`w-2 h-2 rounded-full ${s.type==="fractal_testnet"?"bg-yellow-500":"bg-green-500"}`}),t.jsx("span",{className:"text-sm font-medium",children:s.name}),t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsxs(lt,{isOpen:n,onClose:()=>a(!1),title:"Select Network",children:[t.jsx("div",{className:"space-y-3",children:e.map(i=>t.jsxs("button",{onClick:()=>o(i.type),className:`w-full p-4 border rounded-lg flex items-center space-x-3 transition-all ${s.type===i.type?"border-fractal-orange bg-fractal-orange/5":"border-gray-200 dark:border-gray-700 hover:border-fractal-orange hover:bg-fractal-orange/5"}`,children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${i.type==="fractal_testnet"?"bg-yellow-500":"bg-green-500"}`}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium",children:i.name}),t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.type==="fractal_testnet"?"Test Network":"Main Network"})]}),s.type===i.type&&t.jsx("div",{className:"text-fractal-orange",children:t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},i.type))}),t.jsx("div",{className:"mt-6 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:t.jsxs("div",{className:"flex items-start space-x-2",children:[t.jsx("svg",{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Network Switch Warning"}),t.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"Switching networks will reset your current session and may affect pending transactions."})]})]})})]})]})},St=()=>{const{currentLayer:s,availableLayers:e,switchLayer:r,refreshLayers:n}=it(),[a,o]=p.useState(!1),[i,l]=p.useState(!1),c=g=>{r(g),o(!1)},u=async()=>{l(!0);try{await n()}finally{l(!1)}},d=g=>{switch(g){case"active":return"bg-green-500";case"syncing":return"bg-yellow-500 animate-pulse";case"offline":return"bg-red-500";default:return"bg-gray-500"}},h=g=>{switch(g){case"low":return"text-green-600 dark:text-green-400";case"medium":return"text-yellow-600 dark:text-yellow-400";case"high":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}};return s?t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:()=>o(!0),className:"flex items-center space-x-2 px-3 py-2 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-fractal-orange transition-colors",children:[t.jsx("div",{className:`w-2 h-2 rounded-full ${d(s.status)}`}),t.jsx("span",{className:"text-sm font-medium",children:s.name}),t.jsxs("span",{className:"layer-indicator",children:["L",s.level]}),t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t.jsx(lt,{isOpen:a,onClose:()=>o(!1),title:"Fractal Layers",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h4",{className:"font-medium",children:"Available Layers"}),t.jsx("button",{onClick:u,disabled:i,className:"p-2 text-gray-500 hover:text-fractal-orange transition-colors",title:"Refresh layers",children:t.jsx("svg",{className:`w-4 h-4 ${i?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),t.jsx("div",{className:"space-y-3",children:e.map(g=>t.jsxs("button",{onClick:()=>c(g.id),className:`w-full p-4 border rounded-lg text-left transition-all ${(s==null?void 0:s.id)===g.id?"border-fractal-orange bg-fractal-orange/5":"border-gray-200 dark:border-gray-700 hover:border-fractal-orange hover:bg-fractal-orange/5"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${d(g.status)}`}),t.jsx("span",{className:"font-medium",children:g.name}),t.jsxs("span",{className:"layer-indicator",children:["L",g.level]})]}),(s==null?void 0:s.id)===g.id&&t.jsx("div",{className:"text-fractal-orange",children:t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Status:"}),t.jsx("span",{className:"ml-1 capitalize",children:g.status})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Block:"}),t.jsx("span",{className:"ml-1 font-mono",children:g.blockHeight.toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Anchored:"}),t.jsx("span",{className:"ml-1",children:g.anchored?"✓":"✗"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Congestion:"}),t.jsx("span",{className:`ml-1 capitalize ${h(g.congestion)}`,children:g.congestion})]})]}),t.jsxs("div",{className:"mt-2 text-sm",children:[t.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Fee Rate:"}),t.jsxs("span",{className:"ml-1 font-mono",children:[g.feeRate," sat/vB"]})]})]},g.id))}),t.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:t.jsxs("div",{className:"flex items-start space-x-2",children:[t.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Fractal Layer System"}),t.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1",children:"Each layer operates as a recursive BCSP instance. Higher layers may have different fee rates and confirmation times."})]})]})})]})})]}):t.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-lg border border-gray-200 dark:border-gray-700",children:[t.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),t.jsx("span",{className:"text-sm text-gray-500",children:"No Layer"})]})},Is=()=>{const{theme:s,toggleTheme:e}=er(),{currentNetwork:r}=it(),{isConnected:n,currentNetwork:a,requiredNetwork:o}=oe(),[i,l]=p.useState(!1),c=n&&a&&a.includes("testnet");return t.jsx("header",{className:"border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-fractal-gray sticky top-0 z-50",children:t.jsxs("div",{className:"container mx-auto px-responsive",children:[t.jsxs("div",{className:"flex items-center justify-between h-16 sm:h-20",children:[t.jsx("div",{className:"flex items-center space-responsive-x",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center overflow-hidden",children:t.jsx("img",{src:"fbr.png",alt:"Fractal Bitcoin Runes",className:"w-full h-full object-contain"})}),t.jsxs("div",{children:[t.jsxs("h1",{className:"text-responsive-base font-bold gradient-text",children:[t.jsx("span",{className:"hidden sm:inline",children:"Fractal Bitcoin"}),t.jsx("span",{className:"sm:hidden",children:"FB"})," Swap"]}),t.jsx("p",{className:"hidden sm:block text-xs text-gray-500 dark:text-gray-400 font-mono",children:"Runes ⟷ FB Atomic Swaps • Fractal Bitcoin Mainnet"})]})]})}),t.jsxs("div",{className:"hidden lg:flex items-center space-x-4",children:[n&&t.jsx("div",{className:"flex items-center space-x-2",children:c?t.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400 rounded-lg text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),t.jsx("span",{children:"Wrong Network"})]}):t.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 rounded-lg text-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Fractal Mainnet"})]})}),t.jsx(Nt,{}),t.jsx(St,{}),t.jsx(jt,{}),t.jsx("button",{onClick:e,className:"touch-button p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:`Switch to ${s==="light"?"dark":"light"} mode`,children:s==="light"?t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})})]}),t.jsxs("div",{className:"lg:hidden flex items-center space-x-2",children:[t.jsx("button",{onClick:e,className:"touch-button p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:`Switch to ${s==="light"?"dark":"light"} mode`,children:s==="light"?t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}),t.jsx("button",{onClick:()=>l(!i),className:"touch-button p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Open menu",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i?t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),i&&t.jsxs("div",{className:"lg:hidden border-t border-gray-200 dark:border-gray-700 py-4 space-responsive-y mobile-safe-area",children:[n&&t.jsx("div",{className:"flex items-center justify-center",children:c?t.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-400 rounded-lg text-responsive-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),t.jsx("span",{children:"Wrong Network"})]}):t.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 rounded-lg text-responsive-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:"Fractal Mainnet"})]})}),t.jsxs("div",{className:"space-responsive-y",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-responsive-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Network"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Nt,{}),t.jsx(St,{})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-responsive-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Wallet Connection"}),t.jsx(jt,{})]})]})]}),c&&t.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-lg",children:t.jsxs("div",{className:"flex items-start space-x-2",children:[t.jsx("svg",{className:"w-5 h-5 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-red-800 dark:text-red-200 font-medium text-responsive-sm",children:"Please switch to Fractal Bitcoin Mainnet"}),t.jsxs("p",{className:"text-red-600 dark:text-red-400 text-responsive-xs mt-1 break-words",children:["Your wallet is currently connected to ",a||"an unsupported network",". Please switch to Fractal Bitcoin Mainnet to use this platform."]})]})]})})]})})},Ms=()=>t.jsx("footer",{className:"border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-fractal-gray",children:t.jsxs("div",{className:"container mx-auto px-4 py-6",children:[t.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0",children:[t.jsx("div",{className:"flex items-center space-x-4",children:t.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("span",{className:"font-mono",children:"Powered by "}),t.jsx("span",{className:"font-semibold gradient-text",children:"Fractal Bitcoin"})]})}),t.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[t.jsx("a",{href:"https://fractalbitcoin.io",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 dark:text-gray-400 hover:text-fractal-orange transition-colors",children:"About Fractal"}),t.jsx("a",{href:"https://docs.fractalbitcoin.io",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 dark:text-gray-400 hover:text-fractal-orange transition-colors",children:"Documentation"}),t.jsx("a",{href:"https://github.com/fractal-bitcoin",target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 dark:text-gray-400 hover:text-fractal-orange transition-colors",children:"GitHub"})]}),t.jsx("div",{className:"flex items-center space-x-4",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-mono",children:"Network Active"})]})})]}),t.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-2 md:space-y-0",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"© 2024 Fractal Bitcoin Swap Platform. Built with recursive BCSP instances."}),t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-400",children:[t.jsx("span",{children:"⚠️ Testnet Only"}),t.jsx("span",{children:"•"}),t.jsx("span",{children:"Use at your own risk"})]})]})})]})}),Us=({children:s})=>{const{theme:e}=er();return t.jsx("div",{className:`min-h-screen flex flex-col ${e==="dark"?"dark":""}`,children:t.jsxs("div",{className:"bg-white dark:bg-fractal-gray transition-colors duration-200",children:[t.jsx(Is,{}),t.jsx("main",{className:"flex-1 container mx-auto px-4 py-8",children:s}),t.jsx(Ms,{})]})})},_s="modulepreload",qs=function(s){return"/swap/"+s},Ct={},Ds=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=qs(c),c in Ct)return;Ct[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":_s,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((g,v)=>{h.addEventListener("load",g),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return aconsole.log("[TRACE] Promise.then in index-DJ07tDoB.js");for(const l of i||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},re=class re{constructor(){L(this,"fbPrice",0);L(this,"lastUpdate",0);L(this,"updateInterval",3e4);L(this,"isUpdating",!1);this.initializePriceUpdates()}static getInstance(){return re.instance||(re.instance=new re),re.instance}async console.log("[TRACE] init method in index-DJ07tDoB.js");await this.updateFBPrice(),setInterval(()=>{this.updateFBPrice()},this.updateInterval)}async updateFBPrice(){if(!this.isUpdating){this.isUpdating=!0;try{const e=await this.fetchFBPriceWithFallback();e&&e>0&&(this.fbPrice=e,this.lastUpdate=Date.now(),console.log(`FB price updated: $${e.toFixed(8)}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`))}catch(e){console.error("Failed to update FB price:",e)}finally{this.isUpdating=!1}}}async fetchFBPriceWithFallback(){const e=[this.fetchFromCoinGecko,this.fetchFromUniSat,this.fetchFromCoinMarketCap,this.fetchFromBinance];for(const r of e)try{const n=await r.call(this);if(n&&n>0)return n}catch(n){console.warn("Price source failed:",n);continue}return null}async fetchFromCoinGecko(){var e;try{const r=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=fractal-bitcoin&vs_currencies=usd",{headers:{Accept:"application/json"}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}});if(!r.ok)throw new Error(`HTTP ${r.status}`);return((e=(await r.json())["fractal-bitcoin"])==null?void 0:e.usd)||null}catch(r){return console.warn("CoinGecko fetch failed:",r),null}}async fetchFromUniSat(){var e;try{const r=await fetch("https://open-api-fractal.unisat.io/v1/indexer/market/price",{headers:{Accept:"application/json"}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}});if(!r.ok)throw new Error(`HTTP ${r.status}`);return((e=(await r.json()).data)==null?void 0:e.price_usd)||null}catch(r){return console.warn("UniSat fetch failed:",r),null}}async fetchFromCoinMarketCap(){var e,r,n,a;try{const o="your_cmc_api_key_here",i=await fetch("https://pro-api.coinmarketcap.com/v1/cryptocurrency/quotes/latest?symbol=FB",{headers:{"X-CMC_PRO_API_KEY":o,Accept:"application/json"}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}});if(!i.ok)throw new Error(`HTTP ${i.status}`);return((a=(n=(r=(e=(await i.json()).data)==null?void 0:e.FB)==null?void 0:r.quote)==null?void 0:n.USD)==null?void 0:a.price)||null}catch(o){return console.warn("CoinMarketCap fetch failed:",o),null}}async fetchFromBinance(){try{const e=await fetch("https://api.binance.com/api/v3/ticker/price?symbol=FBUSDT");if(!e.ok)return null;const r=await e.json();return parseFloat(r.price)||null}catch(e){return console.warn("Binance fetch failed:",e),null}}getFBPrice(){return this.fbPrice}getFBPriceFormatted(){return`$${this.fbPrice.toFixed(8)}`}getLastUpdateTime(){return this.lastUpdate}isStale(){return Date.now()-this.lastUpdate>this.updateInterval*2}async forceUpdate(){await this.updateFBPrice()}convertFBToUSD(e){return e*this.fbPrice}convertUSDToFB(e){return this.fbPrice>0?e/this.fbPrice:0}formatUSDValue(e){return`$${this.convertFBToUSD(e).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:8})}`}};L(re,"instance");let Je=re;const Ws=()=>{var ht;const{isConnected:s,account:e,runesBalances:r}=oe(),[n,a]=p.useState("buy"),[o,i]=p.useState(""),[l,c]=p.useState(""),[u,d]=p.useState(""),[h,g]=p.useState([]),[v,y]=p.useState(null),[m,x]=p.useState(""),[A,F]=p.useState(!1),[j,N]=p.useState(0),[k]=p.useState(()=>Je.getInstance()),[P]=p.useState(()=>Ce.getInstance()),[E,w]=p.useState([]),[C,q]=p.useState(null),[_,V]=p.useState(!1);p.useEffect(()=>{const b=()=>{N(k.getFBPrice())};b();const S=setInterval(b,3e4);return()=>clearInterval(S)},[k]),p.useEffect(()=>{(async()=>{if(!s||!(e!=null&&e.address)){w([]);return}V(!0);try{console.log("🔄 Loading live Runes for address:",e.address);const S=await P.getRunesBalances(e.address);w(S),console.log("✅ Loaded live Runes:",S.length)}catch(S){console.error("❌ Failed to load live Runes:",S),w([])}finally{V(!1)}})()},[s,e==null?void 0:e.address,P]),p.useEffect(()=>{(async()=>{if(!o){q(null);return}try{const S=E.find(R=>R.runeid===o||R.spacedRune===o||R.symbol===o);if(S){const R=await P.getRuneInfo(S.runeid);q(R)}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}}catch(S){console.error("Failed to load rune info:",S),q(null)}})()},[o,E,P]),p.useEffect(()=>{o&&l&&parseFloat(l)>0?_e():(g([]),y(null))},[o,l,n]);const Q=async b=>{try{const[S,R]=await Promise.all([I(b),ue(b)]);if(!S&&!R)return null;const T=Z(S,R,b);return T?{id:n==="buy"?"instant_buy":"instant_sell",type:"instant_market",title:n==="buy"?"🟢 Buy Instantly":"🔴 Sell Instantly",description:T.description,price:T.averagePrice,amount:n==="buy"?T.tokensReceived:b,totalCost:n==="buy"?b:T.fbReceived,available:!0,source:"unified",fees:T.totalFees,priceImpact:T.priceImpact,executionPlan:T}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}:null}catch(S){return console.error("Failed to fetch unified quote:",S),null}},I=async b=>{try{return Math.random()>.3?{available:!0,price:n==="buy"?1e-6:8e-7,liquidity:b*.7,fees:b*.002,source:"orderbook"}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}:null}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");return null}},ue=async b=>{try{return Math.random()>.2?{available:!0,price:9e-7,liquidity:b*.8,fees:b*.003,priceImpact:.5,source:"pool"}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}:null}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");return null}},Z=(b,S,R)=>{if(!b&&!S)return null;let T={routes:[],totalFees:0,averagePrice:0,tokensReceived:0,fbReceived:0,priceImpact:0,description:""};if(!b&&S)T={routes:[{source:"pool",amount:R,price:S.price}],totalFees:S.fees+R*.001,averagePrice:S.price,tokensReceived:n==="buy"?R/S.price*1e8:0,fbReceived:n==="sell"?R*S.price/1e8:0,priceImpact:S.priceImpact,description:"Executed via liquidity pool with optimal routing"};else if(b&&!S)T={routes:[{source:"orderbook",amount:R,price:b.price}],totalFees:b.fees+R*.0015,averagePrice:b.price,tokensReceived:n==="buy"?R/b.price*1e8:0,fbReceived:n==="sell"?R*b.price/1e8:0,priceImpact:0,description:"Executed via orderbook with automatic order splitting and relisting"};else if(n==="buy"?b.price<S.price:b.price>S.price){const M=Math.min(R,b.liquidity),O=R-M;T={routes:[{source:"orderbook",amount:M,price:b.price},...O>0?[{source:"pool",amount:O,price:S.price}]:[]],totalFees:b.fees+(O>0?S.fees*(O/R):0)+R*.0015,averagePrice:(b.price*M+S.price*O)/R,tokensReceived:n==="buy"?(M/b.price+O/S.price)*1e8:0,fbReceived:n==="sell"?(M*b.price+O*S.price)/1e8:0,priceImpact:O>0?S.priceImpact*(O/R):0,description:O>0?`Best execution: ${(M/R*100).toFixed(0)}% via orderbook, ${(O/R*100).toFixed(0)}% via pool`:"Executed via orderbook with optimal pricing"}}else{const M=Math.min(R,S.liquidity),O=R-M;T={routes:[{source:"pool",amount:M,price:S.price},...O>0?[{source:"orderbook",amount:O,price:b.price}]:[]],totalFees:S.fees+(O>0?b.fees*(O/R):0)+R*.0015,averagePrice:(S.price*M+b.price*O)/R,tokensReceived:n==="buy"?(M/S.price+O/b.price)*1e8:0,fbReceived:n==="sell"?(M*S.price+O*b.price)/1e8:0,priceImpact:S.priceImpact*(M/R),description:O>0?`Best execution: ${(M/R*100).toFixed(0)}% via pool, ${(O/R*100).toFixed(0)}% via orderbook`:"Executed via liquidity pool with optimal routing"}}return T},_e=async()=>{F(!0);try{await new Promise(J=>setTimeout(J,500));const b=parseFloat(l),S=await Q(b),R={hasLiveListings:S!==null,hasLiveBuyOrders:S!==null,hasPoolLiquidity:S!==null,bestAskPrice:S?S.price:null,bestBidPrice:S?S.price:null,poolPrice:S?S.price:null,poolLiquidity:S?5e7:0}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);};y(R);const T=[];S&&T.push(S),T.push({id:n==="buy"?"limit_buy":"limit_sell",type:"limit_order",title:"📋 Create Limit Order",description:S?"Set a custom price and wait for the market to reach your target":"No liquidity available - place order for future fulfillment",price:0,amount:n==="buy"?0:b,totalCost:0,available:!0,source:"pending",fees:0}),g(T),T.length>0&&d(T[0].id)}catch(b){console.error("Failed to load trade options:",b)}finally{F(!1)}},Y=async()=>{const b=h.find(S=>S.id===u);if(b){if(b.type==="limit_order"&&!m){alert("Please set your desired price for the limit order");return}try{console.log("Executing trade:",{direction:n,rune:o,option:b,customPrice:m}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}),b.type==="instant_market"?alert(`${n==="buy"?"Buying":"Selling"} ${b.amount.toLocaleString()} ${o} instantly`):b.type==="pool_swap"?alert(`Swapping via liquidity pool with ${b.priceImpact}% price impact`):b.type==="limit_order"&&alert(`Placing ${n} order at ${m} FB per ${o}`)}catch(S){console.error("Trade failed:",S)}}};return s?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 dark:from-blue-900/20 dark:to-green-900/20 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-lg",children:"₿"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:"Fractal Bitcoin (FB)"}),t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Live Market Price"})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:j>0?`$${j.toFixed(8)}`:"Loading..."}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("div",{className:`w-2 h-2 rounded-full ${k.isStale()?"bg-red-500":"bg-green-500"}`}),t.jsx("span",{children:k.isStale()?"Price stale":"Live price"}),t.jsx("button",{onClick:()=>k.forceUpdate(),className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:"🔄"})]})]})]})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[t.jsx("div",{className:"flex justify-center mb-6",children:t.jsxs("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-1 flex",children:[t.jsx("button",{onClick:()=>a("buy"),className:`px-6 py-2 rounded-md font-medium transition-all ${n==="buy"?"bg-green-600 text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:text-green-600"}`,children:"🟢 Buy"}),t.jsx("button",{onClick:()=>a("sell"),className:`px-6 py-2 rounded-md font-medium transition-all ${n==="sell"?"bg-red-600 text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:text-red-600"}`,children:"🔴 Sell"})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Select Rune ",_&&t.jsx("span",{className:"text-blue-500",children:"(Loading live data...)"})]}),t.jsxs("select",{value:o,onChange:b=>i(b.target.value),className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600",disabled:_,children:[t.jsx("option",{value:"",children:_?"Loading live Runes...":"Choose a rune..."}),E.map(b=>{const S=P.getFormattedBalance(b),R=b.spacedRune||b.symbol||b.runeid;return t.jsxs("option",{value:b.runeid,children:[R," (Balance: ",S," ",b.symbol||"",")"]},b.runeid)}),!_&&E.length===0&&s&&t.jsx("option",{value:"",disabled:!0,children:"No Runes found in wallet"})]}),C&&t.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:t.jsxs("div",{className:"text-sm space-y-1",children:[t.jsxs("div",{className:"font-medium text-blue-800 dark:text-blue-200",children:["📊 ",C.spacedRune||C.rune]}),t.jsxs("div",{className:"text-blue-700 dark:text-blue-300",children:[t.jsx("span",{className:"font-medium",children:"ID:"})," ",C.runeid]}),t.jsxs("div",{className:"text-blue-700 dark:text-blue-300",children:[t.jsx("span",{className:"font-medium",children:"Symbol:"})," ",C.symbol||"N/A"]}),t.jsxs("div",{className:"text-blue-700 dark:text-blue-300",children:[t.jsx("span",{className:"font-medium",children:"Holders:"})," ",C.holders.toLocaleString()]}),t.jsxs("div",{className:"text-blue-700 dark:text-blue-300",children:[t.jsx("span",{className:"font-medium",children:"Supply:"})," ",P.formatRuneAmount(C.supply,C.divisibility)]}),C.mintable&&t.jsx("div",{className:"text-green-600 dark:text-green-400 text-xs",children:"✅ Still mintable"})]})})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:n==="buy"?"FB Amount to Spend":"Rune Amount to Sell"}),t.jsx("input",{type:"number",value:l,onChange:b=>c(b.target.value),className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:n==="buy"?"0.00000000 FB":"0.00000000 Runes"})]})]})]}),o&&l&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["💱 ",n==="buy"?"Buy":"Sell"," Options for ",o]}),A?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Finding best options..."})]}):h.length===1&&h[0].type==="limit_order"?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[t.jsx("div",{className:"w-10 h-10 bg-yellow-100 dark:bg-yellow-900/30 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-xl",children:"⚠️"})}),t.jsx("h3",{className:"font-semibold text-yellow-800 dark:text-yellow-200 text-lg",children:"No Liquidity Available"})]}),t.jsxs("p",{className:"text-yellow-700 dark:text-yellow-300 mb-4",children:["There's no liquidity available for ",t.jsx("strong",{children:o})," at the moment. Neither the orderbook nor liquidity providers have sufficient ",n==="buy"?"sellers":"buyers","."]}),t.jsxs("div",{className:"bg-yellow-100 dark:bg-yellow-900/40 rounded-lg p-4",children:[t.jsx("h4",{className:"font-medium text-yellow-800 dark:text-yellow-200 mb-2",children:"💡 What you can do:"}),t.jsxs("ul",{className:"text-yellow-700 dark:text-yellow-300 text-sm space-y-1",children:[t.jsx("li",{children:"• Create a limit order and wait for liquidity to appear"}),t.jsx("li",{children:"• Check back later when more traders are active"}),t.jsx("li",{children:"• Try a different amount or token"})]})]})]}),t.jsxs("div",{className:"border rounded-lg p-6 dark:border-gray-600 bg-white dark:bg-gray-800",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-lg",children:"📋"})}),t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Create Limit Order"})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Set your desired price and your order will be filled when liquidity becomes available."}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[t.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Your Desired Price (sats per ",o.split("•")[0]||o,")"]}),t.jsx("input",{type:"number",value:m,onChange:b=>x(b.target.value),className:"w-full p-3 border rounded-lg dark:bg-gray-600 dark:border-gray-500",placeholder:"Enter price in sats",step:"1"}),m&&t.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:t.jsxs("div",{className:"text-sm space-y-1",children:[t.jsx("div",{className:"font-medium text-blue-800 dark:text-blue-200",children:"Order Summary:"}),t.jsxs("div",{className:"text-blue-700 dark:text-blue-300",children:["Price: ",m," sats/",o.split("•")[0]||o,"($",(parseFloat(m)/1e8*j).toFixed(8),")"]}),t.jsx("div",{className:"text-blue-700 dark:text-blue-300",children:n==="buy"?`Spend: ${parseFloat(l)} FB → Get: ${(parseFloat(l)/(parseFloat(m)/1e8)*1e8).toLocaleString()} ${o}`:`Sell: ${parseFloat(l).toLocaleString()} ${o} → Get: ${(parseFloat(l)*(parseFloat(m)/1e8)/1e8).toFixed(8)} FB`})]})})]}),t.jsx("button",{onClick:Y,disabled:!m,className:"w-full mt-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium py-3 px-4 rounded-lg transition-colors disabled:cursor-not-allowed",children:"Create Limit Order"})]})]}):t.jsx("div",{className:"space-y-4",children:h.map((b,S)=>{const R=S===0&&b.type!=="limit_order",T=b.type==="limit_order";return t.jsx("div",{className:`border rounded-lg p-4 dark:border-gray-600 transition-all ${R?"border-green-500 bg-green-50 dark:bg-green-900/10 dark:border-green-400":T?"border-gray-300 bg-gray-50 dark:bg-gray-700 dark:border-gray-600":"border-gray-200 bg-white dark:bg-gray-800"}`,children:t.jsxs("label",{className:"flex items-start cursor-pointer",children:[t.jsx("input",{type:"radio",name:"tradeOption",value:b.id,checked:u===b.id,onChange:J=>d(J.target.value),className:"mt-1 mr-3"}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:`font-medium mb-1 flex items-center gap-2 ${R?"text-green-800 dark:text-green-200":""}`,children:[b.title,R&&t.jsx("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 text-xs px-2 py-1 rounded-full font-medium",children:"Recommended"})]}),t.jsx("div",{className:`text-sm mb-3 ${R?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400"}`,children:b.description}),!T&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Average Price:"}),t.jsxs("div",{className:"ml-2 font-medium",children:[t.jsxs("div",{className:R?"text-green-800 dark:text-green-200":"",children:[Math.round(b.price*1e8)," sats/",o.split("•")[0]||o]}),t.jsxs("div",{className:"text-xs text-gray-500",children:["$",(b.price*j).toFixed(8)]})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Amount:"}),t.jsx("span",{className:`ml-2 font-medium ${R?"text-green-800 dark:text-green-200":""}`,children:b.amount.toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total:"}),t.jsxs("div",{className:"ml-2 font-medium",children:[t.jsxs("div",{className:R?"text-green-800 dark:text-green-200":"",children:[b.totalCost.toFixed(8)," FB"]}),t.jsxs("div",{className:"text-xs text-gray-500",children:["$",(b.totalCost*j).toFixed(2)]})]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Fees:"}),t.jsxs("div",{className:"ml-2 font-medium",children:[t.jsxs("div",{className:R?"text-green-800 dark:text-green-200":"",children:[b.fees.toFixed(8)," FB"]}),t.jsxs("div",{className:"text-xs text-gray-500",children:["$",(b.fees*j).toFixed(4)]})]})]})]}),b.executionPlan&&t.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-medium text-blue-800 dark:text-blue-200 mb-2",children:"🎯 Execution Strategy:"}),t.jsx("div",{className:"text-blue-700 dark:text-blue-300 mb-2",children:b.executionPlan.description}),b.executionPlan.routes&&b.executionPlan.routes.length>1&&t.jsxs("div",{className:"space-y-1",children:[t.jsx("div",{className:"font-medium text-blue-800 dark:text-blue-200 text-xs",children:"Route Details:"}),b.executionPlan.routes.map((J,M)=>t.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400 flex justify-between",children:[t.jsxs("span",{children:[J.source==="orderbook"?"📋 Orderbook":"💧 Pool",":",(J.amount/parseFloat(l)*100).toFixed(0),"%"]}),t.jsxs("span",{children:[Math.round(J.price*1e8)," sats"]})]},M))]}),t.jsx("div",{className:"mt-2 pt-2 border-t border-blue-200 dark:border-blue-800",children:t.jsxs("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:[t.jsx("div",{className:"font-medium mb-1",children:"Fee Breakdown:"}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"• Trading fees"}),t.jsxs("span",{children:[(b.fees*.6).toFixed(8)," FB"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"• Order splitting/routing"}),t.jsxs("span",{children:[(b.fees*.25).toFixed(8)," FB"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"• Relisting remainder"}),t.jsxs("span",{children:[(b.fees*.15).toFixed(8)," FB"]})]})]})]})})]})}),b.priceImpact&&b.priceImpact>0&&t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Price Impact:"}),t.jsxs("span",{className:`font-medium ${b.priceImpact>1?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:[b.priceImpact.toFixed(2),"%"]})]})]}),T&&u===b.id&&t.jsxs("div",{className:"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded",children:[t.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Your Desired Price (sats per ",o.split("•")[0]||o,")"]}),t.jsx("input",{type:"number",value:m,onChange:J=>x(J.target.value),className:"w-full p-2 border rounded dark:bg-gray-600 dark:border-gray-500",placeholder:"Enter price in sats",step:"1"}),m&&t.jsxs("div",{className:"mt-2 text-sm",children:[t.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:["Price: ",m," sats/",o.split("•")[0]||o," ($",(parseFloat(m)/1e8*j).toFixed(8),")"]}),t.jsxs("div",{className:"text-gray-600 dark:text-gray-400 mt-1",children:["Total: ",n==="buy"?`${parseFloat(l)} FB for ${(parseFloat(l)/(parseFloat(m)/1e8)*1e8).toLocaleString()} ${o}`:`${parseFloat(l).toLocaleString()} ${o} for ${(parseFloat(l)*(parseFloat(m)/1e8)/1e8).toFixed(8)} FB`]})]})]})]})]})},b.id)})}),h.length>0&&t.jsx("button",{onClick:Y,disabled:!u||((ht=h.find(b=>b.id===u))==null?void 0:ht.type)==="limit_order"&&!m,className:`w-full mt-6 py-3 rounded-lg font-medium transition-colors ${n==="buy"?"bg-green-600 text-white hover:bg-green-700 disabled:bg-gray-400":"bg-red-600 text-white hover:bg-red-700 disabled:bg-gray-400"} disabled:cursor-not-allowed`,children:n==="buy"?"🟢 Execute Buy":"🔴 Execute Sell"})]}),v&&C&&t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-6 rounded-xl",children:[t.jsxs("h4",{className:"font-medium mb-3",children:["📊 Live Market Status for ",C.spacedRune]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-blue-600",children:"Orderbook"}),t.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:n==="buy"?v.hasLiveListings?"✅ Live listings available":"❌ No live listings":v.hasLiveBuyOrders?"✅ Live buy orders":"❌ No live buy orders"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-green-600",children:"Liquidity Pool"}),t.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:v.hasPoolLiquidity?`✅ ${v.poolLiquidity.toLocaleString()} available`:"❌ No pool liquidity"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-purple-600",children:"Best Price"}),t.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:n==="buy"?v.bestAskPrice?t.jsxs("div",{children:[t.jsxs("div",{children:[Math.round(v.bestAskPrice*1e8)," sats/",C.symbol||C.spacedRune]}),t.jsxs("div",{className:"text-xs",children:["$",(v.bestAskPrice*j).toFixed(8)]})]}):"No asks":v.bestBidPrice?t.jsxs("div",{children:[t.jsxs("div",{children:[Math.round(v.bestBidPrice*1e8)," sats/",C.symbol||C.spacedRune]}),t.jsxs("div",{className:"text-xs",children:["$",(v.bestBidPrice*j).toFixed(8)]})]}):"No bids"})]})]}),t.jsx("div",{className:"mt-4 pt-4 border-t border-blue-200 dark:border-blue-800",children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-xs",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Total Supply"}),t.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:P.formatRuneAmount(C.supply,C.divisibility)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Holders"}),t.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:C.holders.toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Transactions"}),t.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:C.transactions.toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Status"}),t.jsx("div",{className:`${C.mintable?"text-green-600":"text-gray-600"} dark:text-gray-400`,children:C.mintable?"🟢 Mintable":"🔴 Complete"})]})]})}),t.jsx("div",{className:"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:t.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["💡 ",t.jsx("strong",{children:"Price Discovery:"})," Prices are determined by live trading activity on our platform. As users trade, market prices will crystallize and reflect true demand."]})})]})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("span",{className:"text-2xl",children:"💱"})}),t.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Connect Wallet to Trade"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Access instant trades, liquidity provision, and limit orders"})]})},zs=()=>{var E;const{isConnected:s,account:e,runesBalances:r}=oe(),[n,a]=p.useState("pools"),[o,i]=p.useState([]),[l,c]=p.useState([]),[u,d]=p.useState(""),[h,g]=p.useState({rune:"",fb:""}),[v,y]=p.useState(25),[m,x]=p.useState({runeId:"",runeName:"",initialRuneAmount:"",initialFBAmount:""}),[A,F]=p.useState(!1);p.useEffect(()=>{s&&e&&j()},[s,e]);const j=async()=>{try{c([{id:"black•myth•sun•wu•kong_FB",tokenA:"black•myth•sun•wu•kong",tokenB:"FB",reserveA:50000000000000n,reserveB:500000000n,totalLPShares:1000000000n,fee:30,tvl:"5.0 FB",volume24h:"1.2 FB",apy:24.5}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);},{id:"pups•world•peace_FB",tokenA:"pups•world•peace",tokenB:"FB",reserveA:200000000000000n,reserveB:200000000n,totalLPShares:500000000n,fee:30,tvl:"2.0 FB",volume24h:"0.8 FB",apy:18.2}]),i([{poolId:"black•myth•sun•wu•kong_FB",tokenA:"black•myth•sun•wu•kong",tokenB:"FB",liquidityShares:100000000n,tokenAAmount:5000000000000n,tokenBAmount:50000000n,accumulatedRewards:2500000n,apy:24.5,sharePercentage:10}])}catch(w){console.error("Failed to load LP data:",w)}},N=async()=>{var Q;if(!m.runeId||!m.initialRuneAmount||!m.initialFBAmount){alert("Please fill all fields");return}if(!A){alert("Please acknowledge the risks before creating a pool");return}const w=parseFloat(m.initialRuneAmount),C=parseFloat(m.initialFBAmount);if(w<=0||C<=0){alert("Please enter valid amounts greater than 0");return}const q=r==null?void 0:r[m.runeName];if(q){const I=Number(q.amount)/1e8;if(w>I){alert(`Insufficient ${m.runeName} balance. Available: ${I.toLocaleString()}`);return}}const _=l.find(I=>I.tokenA===m.runeName||I.tokenA===m.runeId||I.id.includes(m.runeName)||I.id.includes(m.runeId));if(_)if(window.confirm(`A liquidity pool for ${m.runeName}/FB already exists!

Current Pool Stats:
• TVL: ${_.tvl}
• APY: ${_.apy}%
• 24h Volume: ${_.volume24h}

Would you like to add liquidity to the existing pool instead of creating a new one?`)){d(_.id),g({rune:m.initialRuneAmount,fb:m.initialFBAmount}),a("add");return}else{alert("Pool creation cancelled. Each token pair can only have one liquidity pool.");return}if(window.confirm(`⚠️ FINAL CONFIRMATION ⚠️

You are about to create a new liquidity pool:

Token Pair: ${m.runeName} / FB
Your Contribution:
• ${w.toLocaleString()} ${m.runeName}
• ${C} FB

Initial Price: 1 ${m.runeName} = ${(C/w).toFixed(8)} FB

⚠️ RISKS:
• Impermanent loss if token prices diverge
• You'll be the sole liquidity provider initially
• Market price changes will affect your position

✅ REWARDS:
• Earn 10% of all trading fees from this pool
• Higher trading volume = higher rewards

Do you want to proceed with creating this pool?`))try{console.log("Creating new liquidity pool:",{tokenA:m.runeName,tokenB:"FB",initialAmountA:w,initialAmountB:C,initialPrice:C/w,creator:e==null?void 0:e.address}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);});const I=(Q=document.querySelector('button[onclick*="handleCreatePool"]'))==null?void 0:Q.textContent,ue=document.querySelector('button[onclick*="handleCreatePool"]');ue&&(ue.textContent="🔄 Creating Pool...",ue.disabled=!0),await new Promise(Y=>setTimeout(Y,2e3));const Z={id:`${m.runeName}_FB`,tokenA:m.runeName,tokenB:"FB",reserveA:BigInt(Math.floor(w*1e8)),reserveB:BigInt(Math.floor(C*1e8)),totalLPShares:BigInt(Math.floor(Math.sqrt(w*C)*1e8)),fee:30,tvl:`${C} FB`,volume24h:"0 FB",apy:0};c(Y=>[Z,...Y]);const _e={poolId:Z.id,tokenA:m.runeName,tokenB:"FB",liquidityShares:Z.totalLPShares,tokenAAmount:Z.reserveA,tokenBAmount:Z.reserveB,accumulatedRewards:0n,apy:0,sharePercentage:100};i(Y=>[_e,...Y]),x({runeId:"",runeName:"",initialRuneAmount:"",initialFBAmount:""}),F(!1),alert(`🎉 Pool Created Successfully!

Your new ${m.runeName}/FB pool is now live!

• You own 100% of the pool initially
• Start earning fees as soon as trading begins
• Other users can now add liquidity to your pool

Check the "My Rewards" tab to monitor your earnings!`),a("rewards")}catch(I){console.error("Pool creation failed:",I),alert(`Failed to create pool: ${I.message||"Unknown error"}`)}finally{const I=document.querySelector('button[onclick*="handleCreatePool"]');I&&originalText&&(I.textContent=originalText,I.disabled=!1)}},k=async()=>{if(!u||!h.rune||!h.fb){alert("Please select pool and enter amounts");return}try{console.log("Adding liquidity:",{pool:u,amounts:h}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}),alert("Add liquidity will be implemented with liquidityPoolOrchestrator service")}catch(w){console.error("Add liquidity failed:",w)}},P=async w=>{try{console.log("Claiming rewards for pool:",w),alert("Claim rewards will be implemented with liquidityPoolOrchestrator service")}catch(C){console.error("Claim rewards failed:",C)}};return s?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex flex-wrap justify-center gap-2 mb-6",children:[{key:"pools",label:"💧 All Pools",icon:"💧"},{key:"add",label:"➕ Add Liquidity",icon:"➕"},{key:"remove",label:"➖ Remove Liquidity",icon:"➖"},{key:"create",label:"🆕 Create Pool",icon:"🆕"},{key:"rewards",label:"🎁 My Rewards",icon:"🎁"}].map(w=>t.jsx("button",{onClick:()=>a(w.key),className:`px-4 py-2 rounded-lg font-medium transition-all text-sm ${n===w.key?"bg-blue-600 text-white shadow-lg":"text-gray-600 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20"}`,children:w.label},w.key))}),n==="pools"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 p-6 rounded-xl",children:[t.jsx("h3",{className:"text-xl font-bold mb-2",children:"💧 AMM - Provide Liquidity"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Provide liquidity to Rune/FB pairs and earn 10% of trading fees proportional to your contribution"})]}),t.jsx("div",{className:"grid gap-4",children:l.map(w=>t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border dark:border-gray-700",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsxs("div",{children:[t.jsxs("h4",{className:"text-lg font-semibold",children:[w.tokenA," / ",w.tokenB]}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Fee: ",w.fee/100,"% • TVL: ",w.tvl]})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"text-lg font-bold text-green-600",children:[w.apy,"% APY"]}),t.jsxs("div",{className:"text-sm text-gray-600",children:["24h Vol: ",w.volume24h]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[t.jsxs("div",{children:[t.jsxs("span",{className:"text-gray-600",children:["Reserve ",w.tokenA,":"]}),t.jsx("p",{className:"font-medium",children:(Number(w.reserveA)/1e8).toLocaleString()})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Reserve FB:"}),t.jsxs("p",{className:"font-medium",children:[(Number(w.reserveB)/1e8).toFixed(8)," FB"]})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{d(w.id),a("add")},className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"➕ Add Liquidity"}),t.jsx("button",{onClick:()=>{d(w.id),a("remove")},className:"flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-gray-700 transition-colors",children:"➖ Remove"})]})]},w.id))})]}),n==="add"&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:"➕ Add Liquidity"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Pool"}),t.jsxs("select",{value:u,onChange:w=>d(w.target.value),className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600",children:[t.jsx("option",{value:"",children:"Choose a pool..."}),l.map(w=>t.jsxs("option",{value:w.id,children:[w.tokenA," / ",w.tokenB," (APY: ",w.apy,"% • TVL: ",w.tvl,")"]},w.id))]})]}),u&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[t.jsx("h4",{className:"font-medium mb-2",children:"💡 Liquidity Provider Benefits"}),t.jsxs("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[t.jsx("li",{children:"• Earn 10% of all trading fees from this pair"}),t.jsx("li",{children:"• Rewards distributed proportional to your LP share"}),t.jsx("li",{children:"• Automatic compounding of fee rewards"}),t.jsx("li",{children:"• Withdraw anytime (subject to price impact)"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rune Amount"}),t.jsx("input",{type:"number",value:h.rune,onChange:w=>g(C=>({...C,rune:w.target.value})),className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"0.00000000"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"FB Amount"}),t.jsx("input",{type:"number",value:h.fb,onChange:w=>g(C=>({...C,fb:w.target.value})),className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"0.00000000"})]})]}),t.jsx("button",{onClick:k,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"➕ Add Liquidity & Start Earning"})]})]})]}),n==="create"&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:"🆕 Create New Liquidity Pool"}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"w-6 h-6 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:t.jsx("span",{className:"text-red-600 dark:text-red-400 text-sm",children:"⚠️"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-red-800 dark:text-red-200 mb-2",children:"Important: Impermanent Loss Risk"}),t.jsxs("div",{className:"text-sm text-red-700 dark:text-red-300 space-y-2",children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Impermanent Loss"})," occurs when the price ratio of your deposited tokens changes compared to when you deposited them."]}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[t.jsx("li",{children:"If one token's price increases significantly vs the other, you may have less total value than holding tokens separately"}),t.jsx("li",{children:"The larger the price change, the greater the impermanent loss"}),t.jsx("li",{children:"You earn trading fees (10% of platform fees) which may offset impermanent loss"}),t.jsx("li",{children:'Loss becomes "permanent" only when you withdraw liquidity'})]}),t.jsx("p",{className:"font-medium",children:"💡 Best for: Token pairs you believe will maintain similar price movements"})]})]})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Rune Token"}),t.jsxs("select",{value:m.runeId,onChange:w=>{const C=w.target.value,q=Object.keys(r||{}).find(V=>{var Q;return V===C||((Q=r[V])==null?void 0:Q.runeId)===C})||C;x(V=>({...V,runeId:C,runeName:q}));const _=l.find(V=>V.tokenA===q||V.tokenA===C);_&&setTimeout(()=>{window.confirm(`A pool for ${q}/FB already exists! Would you like to add liquidity to the existing pool instead?`)&&(d(_.id),a("add"))},100)},className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600",children:[t.jsx("option",{value:"",children:"Choose a Rune from your wallet..."}),r&&Object.entries(r).map(([w,C])=>t.jsxs("option",{value:C.runeId||w,children:[w," (Balance: ",(Number(C.amount)/1e8).toLocaleString(),")"]},w))]}),!r||Object.keys(r).length===0&&t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No Runes found in your wallet. Make sure your wallet is connected and has Fractal Bitcoin Runes."})]}),m.runeId&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[t.jsx("h4",{className:"font-medium text-blue-800 dark:text-blue-200 mb-3",children:"💭 Set Your Price Prediction"}),t.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mb-4",children:"Set the initial price ratio based on your market prediction. This determines how much FB you'll need to pair with your Runes."}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Your ",m.runeName," Amount"]}),t.jsx("input",{type:"number",value:m.initialRuneAmount,onChange:w=>{const C=w.target.value;if(x(q=>({...q,initialRuneAmount:C})),C&&!m.initialFBAmount){const q=(parseFloat(C)/1e6).toFixed(8);x(_=>({..._,initialFBAmount:q}))}},className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"0.00000000",max:(E=r==null?void 0:r[m.runeName])!=null&&E.amount?(Number(r[m.runeName].amount)/1e8).toString():void 0}),(r==null?void 0:r[m.runeName])&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Available: ",(Number(r[m.runeName].amount)/1e8).toLocaleString()," ",m.runeName]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Paired FB Amount"}),t.jsx("input",{type:"number",value:m.initialFBAmount,onChange:w=>x(C=>({...C,initialFBAmount:w.target.value})),className:"w-full p-3 border rounded-lg dark:bg-gray-700 dark:border-gray-600",placeholder:"0.00000000"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This sets your predicted price ratio"})]})]}),m.initialRuneAmount&&m.initialFBAmount&&t.jsxs("div",{className:"mt-4 p-3 bg-white dark:bg-gray-800 rounded-lg border",children:[t.jsx("h5",{className:"font-medium mb-2",children:"📊 Your Price Prediction:"}),t.jsxs("div",{className:"text-sm space-y-1",children:[t.jsxs("p",{children:[t.jsxs("strong",{children:["1 ",m.runeName]})," = "," ",t.jsxs("strong",{children:[(parseFloat(m.initialFBAmount)/parseFloat(m.initialRuneAmount)).toFixed(8)," FB"]})]}),t.jsxs("p",{children:[t.jsx("strong",{children:"1 FB"})," = "," ",t.jsxs("strong",{children:[(parseFloat(m.initialRuneAmount)/parseFloat(m.initialFBAmount)).toFixed(2)," ",m.runeName]})]})]})]})]}),t.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"w-6 h-6 bg-yellow-100 dark:bg-yellow-900/30 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:t.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 text-sm",children:"📈"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:"Market Price Change Impact"}),t.jsxs("div",{className:"text-sm text-yellow-700 dark:text-yellow-300 space-y-2",children:[t.jsx("p",{children:t.jsxs("strong",{children:["If ",m.runeName," price goes UP vs FB:"]})}),t.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[t.jsxs("li",{children:["Your pool will have less ",m.runeName," and more FB"]}),t.jsxs("li",{children:["You'll miss some upside compared to just holding ",m.runeName]}),t.jsx("li",{children:"But you'll earn trading fees from increased activity"})]}),t.jsx("p",{children:t.jsxs("strong",{children:["If ",m.runeName," price goes DOWN vs FB:"]})}),t.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[t.jsxs("li",{children:["Your pool will have more ",m.runeName," and less FB"]}),t.jsxs("li",{children:["You'll be somewhat protected compared to just holding ",m.runeName]}),t.jsx("li",{children:"Trading fees continue to accumulate"})]}),t.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"💡 The automated market maker keeps the pool balanced, which creates this trade-off"})]})]})]})}),t.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[t.jsx("h4",{className:"font-semibold text-green-800 dark:text-green-200 mb-2",children:"💰 Liquidity Provider Rewards"}),t.jsxs("div",{className:"text-sm text-green-700 dark:text-green-300 space-y-1",children:[t.jsxs("p",{children:["• Earn ",t.jsx("strong",{children:"10% of all trading fees"})," from your pool"]}),t.jsx("p",{children:"• Fees are distributed proportionally to your liquidity share"}),t.jsx("p",{children:"• Rewards auto-compound and can be claimed anytime"}),t.jsx("p",{children:"• Higher trading volume = higher rewards"})]})]}),t.jsxs("div",{className:"pt-4",children:[t.jsx("button",{onClick:N,disabled:!m.initialRuneAmount||!m.initialFBAmount||!A,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed text-white py-4 px-6 rounded-lg font-medium transition-all shadow-lg",children:"🆕 Create Pool & Provide Initial Liquidity"}),(!m.initialRuneAmount||!m.initialFBAmount)&&t.jsx("p",{className:"text-sm text-gray-500 text-center mt-2",children:"Please enter both token amounts to create the pool"}),m.initialRuneAmount&&m.initialFBAmount&&!A&&t.jsx("p",{className:"text-sm text-gray-500 text-center mt-2",children:"Please acknowledge the risks to proceed"})]}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 text-sm",children:t.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:A,onChange:w=>F(w.target.checked),className:"mt-1 rounded border-gray-300 dark:border-gray-600"}),t.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:["I understand the risks of impermanent loss and market price changes. I acknowledge that providing liquidity involves risk and that I may receive less value than holding tokens separately, especially during high volatility periods.",t.jsx("strong",{className:"text-red-600 dark:text-red-400",children:" I accept full responsibility for any losses."})]})]})})]})]})]})]}),n==="rewards"&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg",children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:"🎁 My Liquidity Rewards"}),t.jsx("div",{className:"space-y-4",children:o.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("span",{className:"text-2xl",children:"💧"})}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No liquidity positions found"}),t.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Add liquidity to start earning rewards"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 p-6 rounded-lg",children:[t.jsx("h4",{className:"font-medium mb-2",children:"💰 Total Accumulated Rewards"}),t.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[o.reduce((w,C)=>w+Number(C.accumulatedRewards),0)/1e8," FB"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"From 10% of platform trading fees • Auto-compounding"})]}),o.map(w=>t.jsxs("div",{className:"border rounded-lg p-4 dark:border-gray-600",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("h4",{className:"font-medium",children:[w.tokenA," / ",w.tokenB]}),t.jsxs("span",{className:"text-sm bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 px-3 py-1 rounded-full",children:[w.apy,"% APY"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Your Pool Share:"}),t.jsxs("p",{className:"font-medium",children:[w.sharePercentage.toFixed(2),"%"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Pending Rewards:"}),t.jsxs("p",{className:"font-medium text-green-600",children:[(Number(w.accumulatedRewards)/1e8).toFixed(8)," FB"]})]})]}),t.jsx("button",{onClick:()=>P(w.poolId),className:"w-full bg-green-600 text-white py-2 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"🎁 Claim Rewards"})]},w.poolId))]})})]})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"mb-4",children:t.jsx("div",{className:"w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("span",{className:"text-2xl",children:"💧"})})}),t.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Connect Wallet to Provide Liquidity"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Provide liquidity to earn 10% of platform trading fees"})]})};function nr(s,e){return function(){return s.apply(e,arguments)}}const{toString:Hs}=Object.prototype,{getPrototypeOf:ct}=Object,{iterator:$e,toStringTag:ar}=Symbol,Te=(s=>e=>{const r=Hs.call(e);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),K=s=>(s=s.toLowerCase(),e=>Te(e)===s),Le=s=>e=>typeof e===s,{isArray:ce}=Array,ge=Le("undefined");function Vs(s){return s!==null&&!ge(s)&&s.constructor!==null&&!ge(s.constructor)&&D(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const or=K("ArrayBuffer");function Ks(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&or(s.buffer),e}const Js=Le("string"),D=Le("function"),ir=Le("number"),Oe=s=>s!==null&&typeof s=="object",Xs=s=>s===!0||s===!1,ve=s=>{if(Te(s)!=="object")return!1;const e=ct(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(ar in s)&&!($e in s)},Ys=K("Date"),Gs=K("File"),Qs=K("Blob"),Zs=K("FileList"),en=s=>Oe(s)&&D(s.pipe),tn=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||D(s.append)&&((e=Te(s))==="formdata"||e==="object"&&D(s.toString)&&s.toString()==="[object FormData]"))},rn=K("URLSearchParams"),[sn,nn,an,on]=["ReadableStream","Request","Response","Headers"].map(K),ln=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function xe(s,e,{allOwnKeys:r=!1}={}){if(s===null||typeof s>"u")return;let n,a;if(typeof s!="object"&&(s=[s]),ce(s))for(n=0,a=s.length;n<a;n++)e.call(null,s[n],n,s);else{const o=r?Object.getOwnPropertyNames(s):Object.keys(s),i=o.length;let l;for(n=0;n<i;n++)l=o[n],e.call(null,s[l],l,s)}}function lr(s,e){e=e.toLowerCase();const r=Object.keys(s);let n=r.length,a;for(;n-- >0;)if(a=r[n],e===a.toLowerCase())return a;return null}const se=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:globalThis,cr=s=>!ge(s)&&s!==se;function Xe(){const{caseless:s}=cr(this)&&this||{},e={},r=(n,a)=>{const o=s&&lr(e,a)||a;ve(e[o])&&ve(n)?e[o]=Xe(e[o],n):ve(n)?e[o]=Xe({},n):ce(n)?e[o]=n.slice():e[o]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&xe(arguments[n],r);return e}const cn=(s,e,r,{allOwnKeys:n}={})=>(xe(e,(a,o)=>{r&&D(a)?s[o]=nr(a,r):s[o]=a},{allOwnKeys:n}),s),dn=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),un=(s,e,r,n)=>{s.prototype=Object.create(e.prototype,n),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),r&&Object.assign(s.prototype,r)},hn=(s,e,r,n)=>{let a,o,i;const l={};if(e=e||{},s==null)return e;do{for(a=Object.getOwnPropertyNames(s),o=a.length;o-- >0;)i=a[o],(!n||n(i,s,e))&&!l[i]&&(e[i]=s[i],l[i]=!0);s=r!==!1&&ct(s)}while(s&&(!r||r(s,e))&&s!==Object.prototype);return e},mn=(s,e,r)=>{s=String(s),(r===void 0||r>s.length)&&(r=s.length),r-=e.length;const n=s.indexOf(e,r);return n!==-1&&n===r},fn=s=>{if(!s)return null;if(ce(s))return s;let e=s.length;if(!ir(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=s[e];return r},pn=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&ct(Uint8Array)),gn=(s,e)=>{const n=(s&&s[$e]).call(s);let a;for(;(a=n.next())&&!a.done;){const o=a.value;e.call(s,o[0],o[1])}},xn=(s,e)=>{let r;const n=[];for(;(r=s.exec(e))!==null;)n.push(r);return n},yn=K("HTMLFormElement"),bn=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),At=(({hasOwnProperty:s})=>(e,r)=>s.call(e,r))(Object.prototype),wn=K("RegExp"),dr=(s,e)=>{const r=Object.getOwnPropertyDescriptors(s),n={};xe(r,(a,o)=>{let i;(i=e(a,o,s))!==!1&&(n[o]=i||a)}),Object.defineProperties(s,n)},vn=s=>{dr(s,(e,r)=>{if(D(s)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=s[r];if(D(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},kn=(s,e)=>{const r={},n=a=>{a.forEach(o=>{r[o]=!0})};return ce(s)?n(s):n(String(s).split(e)),r},jn=()=>{},Nn=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function Sn(s){return!!(s&&D(s.append)&&s[ar]==="FormData"&&s[$e])}const Cn=s=>{const e=new Array(10),r=(n,a)=>{if(Oe(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[a]=n;const o=ce(n)?[]:{};return xe(n,(i,l)=>{const c=r(i,a+1);!ge(c)&&(o[l]=c)}),e[a]=void 0,o}}return n};return r(s,0)},An=K("AsyncFunction"),Rn=s=>s&&(Oe(s)||D(s))&&D(s.then)&&D(s.catch),ur=((s,e)=>s?setImmediate:e?((r,n)=>(se.addEventListener("message",({source:a,data:o})=>{a===se&&o===r&&n.length&&n.shift()()},!1),a=>{n.push(a),se.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",D(se.postMessage)),Fn=typeof queueMicrotask<"u"?queueMicrotask.bind(se):typeof process<"u"&&process.nextTick||ur,Pn=s=>s!=null&&D(s[$e]),f={isArray:ce,isArrayBuffer:or,isBuffer:Vs,isFormData:tn,isArrayBufferView:Ks,isString:Js,isNumber:ir,isBoolean:Xs,isObject:Oe,isPlainObject:ve,isReadableStream:sn,isRequest:nn,isResponse:an,isHeaders:on,isUndefined:ge,isDate:Ys,isFile:Gs,isBlob:Qs,isRegExp:wn,isFunction:D,isStream:en,isURLSearchParams:rn,isTypedArray:pn,isFileList:Zs,forEach:xe,merge:Xe,extend:cn,trim:ln,stripBOM:dn,inherits:un,toFlatObject:hn,kindOf:Te,kindOfTest:K,endsWith:mn,toArray:fn,forEachEntry:gn,matchAll:xn,isHTMLForm:yn,hasOwnProperty:At,hasOwnProp:At,reduceDescriptors:dr,freezeMethods:vn,toObjectSet:kn,toCamelCase:bn,noop:jn,toFiniteNumber:Nn,findKey:lr,global:se,isContextDefined:cr,isSpecCompliantForm:Sn,toJSONObject:Cn,isAsyncFn:An,isThenable:Rn,setImmediate:ur,asap:Fn,isIterable:Pn};function B(s,e,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}f.inherits(B,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:f.toJSONObject(this.config),code:this.code,status:this.status}}});const hr=B.prototype,mr={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{mr[s]={value:s}});Object.defineProperties(B,mr);Object.defineProperty(hr,"isAxiosError",{value:!0});B.from=(s,e,r,n,a,o)=>{const i=Object.create(hr);return f.toFlatObject(s,i,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),B.call(i,s.message,e,r,n,a),i.cause=s,i.name=s.name,o&&Object.assign(i,o),i};const Bn=null;function Ye(s){return f.isPlainObject(s)||f.isArray(s)}function fr(s){return f.endsWith(s,"[]")?s.slice(0,-2):s}function Rt(s,e,r){return s?s.concat(e).map(function(a,o){return a=fr(a),!r&&o?"["+a+"]":a}).join(r?".":""):e}function En(s){return f.isArray(s)&&!s.some(Ye)}const $n=f.toFlatObject(f,{},null,function(e){return/^is[A-Z]/.test(e)});function Ie(s,e,r){if(!f.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,r=f.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,x){return!f.isUndefined(x[m])});const n=r.metaTokens,a=r.visitor||d,o=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&f.isSpecCompliantForm(e);if(!f.isFunction(a))throw new TypeError("visitor must be a function");function u(y){if(y===null)return"";if(f.isDate(y))return y.toISOString();if(f.isBoolean(y))return y.toString();if(!c&&f.isBlob(y))throw new B("Blob is not supported. Use a Buffer instead.");return f.isArrayBuffer(y)||f.isTypedArray(y)?c&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function d(y,m,x){let A=y;if(y&&!x&&typeof y=="object"){if(f.endsWith(m,"{}"))m=n?m:m.slice(0,-2),y=JSON.stringify(y);else if(f.isArray(y)&&En(y)||(f.isFileList(y)||f.endsWith(m,"[]"))&&(A=f.toArray(y)))return m=fr(m),A.forEach(function(j,N){!(f.isUndefined(j)||j===null)&&e.append(i===!0?Rt([m],N,o):i===null?m:m+"[]",u(j))}),!1}return Ye(y)?!0:(e.append(Rt(x,m,o),u(y)),!1)}const h=[],g=Object.assign($n,{defaultVisitor:d,convertValue:u,isVisitable:Ye});function v(y,m){if(!f.isUndefined(y)){if(h.indexOf(y)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(y),f.forEach(y,function(A,F){(!(f.isUndefined(A)||A===null)&&a.call(e,A,f.isString(F)?F.trim():F,m,g))===!0&&v(A,m?m.concat(F):[F])}),h.pop()}}if(!f.isObject(s))throw new TypeError("data must be an object");return v(s),e}function Ft(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function dt(s,e){this._pairs=[],s&&Ie(s,this,e)}const pr=dt.prototype;pr.append=function(e,r){this._pairs.push([e,r])};pr.toString=function(e){const r=e?function(n){return e.call(this,n,Ft)}:Ft;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function Tn(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function gr(s,e,r){if(!e)return s;const n=r&&r.encode||Tn;f.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let o;if(a?o=a(e,r):o=f.isURLSearchParams(e)?e.toString():new dt(e,r).toString(n),o){const i=s.indexOf("#");i!==-1&&(s=s.slice(0,i)),s+=(s.indexOf("?")===-1?"?":"&")+o}return s}class Pt{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){f.forEach(this.handlers,function(n){n!==null&&e(n)})}}const xr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ln=typeof URLSearchParams<"u"?URLSearchParams:dt,On=typeof FormData<"u"?FormData:null,In=typeof Blob<"u"?Blob:null,Mn={isBrowser:!0,classes:{URLSearchParams:Ln,FormData:On,Blob:In},protocols:["http","https","file","blob","url","data"]},ut=typeof window<"u"&&typeof document<"u",Ge=typeof navigator=="object"&&navigator||void 0,Un=ut&&(!Ge||["ReactNative","NativeScript","NS"].indexOf(Ge.product)<0),_n=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",qn=ut&&window.location.href||"http://localhost",Dn=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ut,hasStandardBrowserEnv:Un,hasStandardBrowserWebWorkerEnv:_n,navigator:Ge,origin:qn},Symbol.toStringTag,{value:"Module"})),U={...Dn,...Mn};function Wn(s,e){return Ie(s,new U.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,o){return U.isNode&&f.isBuffer(r)?(this.append(n,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function zn(s){return f.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Hn(s){const e={},r=Object.keys(s);let n;const a=r.length;let o;for(n=0;n<a;n++)o=r[n],e[o]=s[o];return e}function yr(s){function e(r,n,a,o){let i=r[o++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),c=o>=r.length;return i=!i&&f.isArray(a)?a.length:i,c?(f.hasOwnProp(a,i)?a[i]=[a[i],n]:a[i]=n,!l):((!a[i]||!f.isObject(a[i]))&&(a[i]=[]),e(r,n,a[i],o)&&f.isArray(a[i])&&(a[i]=Hn(a[i])),!l)}if(f.isFormData(s)&&f.isFunction(s.entries)){const r={};return f.forEachEntry(s,(n,a)=>{e(zn(n),a,r,0)}),r}return null}function Vn(s,e,r){if(f.isString(s))try{return(e||JSON.parse)(s),f.trim(s)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(s)}const ye={transitional:xr,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,o=f.isObject(e);if(o&&f.isHTMLForm(e)&&(e=new FormData(e)),f.isFormData(e))return a?JSON.stringify(yr(e)):e;if(f.isArrayBuffer(e)||f.isBuffer(e)||f.isStream(e)||f.isFile(e)||f.isBlob(e)||f.isReadableStream(e))return e;if(f.isArrayBufferView(e))return e.buffer;if(f.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Wn(e,this.formSerializer).toString();if((l=f.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Ie(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return o||a?(r.setContentType("application/json",!1),Vn(e)):e}],transformResponse:[function(e){const r=this.transitional||ye.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(f.isResponse(e)||f.isReadableStream(e))return e;if(e&&f.isString(e)&&(n&&!this.responseType||a)){const i=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(e)}catch(l){if(i)throw l.name==="SyntaxError"?B.from(l,B.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:U.classes.FormData,Blob:U.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};f.forEach(["delete","get","head","post","put","patch"],s=>{ye.headers[s]={}});const Kn=f.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Jn=s=>{const e={};let r,n,a;return s&&s.split(`
`).forEach(function(i){a=i.indexOf(":"),r=i.substring(0,a).trim().toLowerCase(),n=i.substring(a+1).trim(),!(!r||e[r]&&Kn[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},Bt=Symbol("internals");function me(s){return s&&String(s).trim().toLowerCase()}function ke(s){return s===!1||s==null?s:f.isArray(s)?s.map(ke):String(s)}function Xn(s){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(s);)e[n[1]]=n[2];return e}const Yn=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function qe(s,e,r,n,a){if(f.isFunction(n))return n.call(this,e,r);if(a&&(e=r),!!f.isString(e)){if(f.isString(n))return e.indexOf(n)!==-1;if(f.isRegExp(n))return n.test(e)}}function Gn(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function Qn(s,e){const r=f.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(s,n+r,{value:function(a,o,i){return this[n].call(this,e,a,o,i)},configurable:!0})})}let W=class{constructor(e){e&&this.set(e)}set(e,r,n){const a=this;function o(l,c,u){const d=me(c);if(!d)throw new Error("header name must be a non-empty string");const h=f.findKey(a,d);(!h||a[h]===void 0||u===!0||u===void 0&&a[h]!==!1)&&(a[h||c]=ke(l))}const i=(l,c)=>f.forEach(l,(u,d)=>o(u,d,c));if(f.isPlainObject(e)||e instanceof this.constructor)i(e,r);else if(f.isString(e)&&(e=e.trim())&&!Yn(e))i(Jn(e),r);else if(f.isObject(e)&&f.isIterable(e)){let l={},c,u;for(const d of e){if(!f.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?f.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}i(l,r)}else e!=null&&o(r,e,n);return this}get(e,r){if(e=me(e),e){const n=f.findKey(this,e);if(n){const a=this[n];if(!r)return a;if(r===!0)return Xn(a);if(f.isFunction(r))return r.call(this,a,n);if(f.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=me(e),e){const n=f.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||qe(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let a=!1;function o(i){if(i=me(i),i){const l=f.findKey(n,i);l&&(!r||qe(n,n[l],l,r))&&(delete n[l],a=!0)}}return f.isArray(e)?e.forEach(o):o(e),a}clear(e){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const o=r[n];(!e||qe(this,this[o],o,e,!0))&&(delete this[o],a=!0)}return a}normalize(e){const r=this,n={};return f.forEach(this,(a,o)=>{const i=f.findKey(n,o);if(i){r[i]=ke(a),delete r[o];return}const l=e?Gn(o):String(o).trim();l!==o&&delete r[o],r[l]=ke(a),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return f.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=e&&f.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(a=>n.set(a)),n}static accessor(e){const n=(this[Bt]=this[Bt]={accessors:{}}).accessors,a=this.prototype;function o(i){const l=me(i);n[l]||(Qn(a,i),n[l]=!0)}return f.isArray(e)?e.forEach(o):o(e),this}};W.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);f.reduceDescriptors(W.prototype,({value:s},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(n){this[r]=n}}});f.freezeMethods(W);function De(s,e){const r=this||ye,n=e||r,a=W.from(n.headers);let o=n.data;return f.forEach(s,function(l){o=l.call(r,o,a.normalize(),e?e.status:void 0)}),a.normalize(),o}function br(s){return!!(s&&s.__CANCEL__)}function de(s,e,r){B.call(this,s??"canceled",B.ERR_CANCELED,e,r),this.name="CanceledError"}f.inherits(de,B,{__CANCEL__:!0});function wr(s,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?s(r):e(new B("Request failed with status code "+r.status,[B.ERR_BAD_REQUEST,B.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Zn(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function ea(s,e){s=s||10;const r=new Array(s),n=new Array(s);let a=0,o=0,i;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=n[o];i||(i=u),r[a]=c,n[a]=u;let h=o,g=0;for(;h!==a;)g+=r[h++],h=h%s;if(a=(a+1)%s,a===o&&(o=(o+1)%s),u-i<e)return;const v=d&&u-d;return v?Math.round(g*1e3/v):void 0}}function ta(s,e){let r=0,n=1e3/e,a,o;const i=(u,d=Date.now())=>{r=d,a=null,o&&(clearTimeout(o),o=null),s.apply(null,u)};return[(...u)=>{const d=Date.now(),h=d-r;h>=n?i(u,d):(a=u,o||(o=setTimeout(()=>{o=null,i(a)},n-h)))},()=>a&&i(a)]}const Ae=(s,e,r=3)=>{let n=0;const a=ea(50,250);return ta(o=>{const i=o.loaded,l=o.lengthComputable?o.total:void 0,c=i-n,u=a(c),d=i<=l;n=i;const h={loaded:i,total:l,progress:l?i/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-i)/u:void 0,event:o,lengthComputable:l!=null,[e?"download":"upload"]:!0};s(h)},r)},Et=(s,e)=>{const r=s!=null;return[n=>e[0]({lengthComputable:r,total:s,loaded:n}),e[1]]},$t=s=>(...e)=>f.asap(()=>s(...e)),ra=U.hasStandardBrowserEnv?((s,e)=>r=>(r=new URL(r,U.origin),s.protocol===r.protocol&&s.host===r.host&&(e||s.port===r.port)))(new URL(U.origin),U.navigator&&/(msie|trident)/i.test(U.navigator.userAgent)):()=>!0,sa=U.hasStandardBrowserEnv?{write(s,e,r,n,a,o){const i=[s+"="+encodeURIComponent(e)];f.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),f.isString(n)&&i.push("path="+n),f.isString(a)&&i.push("domain="+a),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(s){const e=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function na(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function aa(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function vr(s,e,r){let n=!na(e);return s&&(n||r==!1)?aa(s,e):e}const Tt=s=>s instanceof W?{...s}:s;function ae(s,e){e=e||{};const r={};function n(u,d,h,g){return f.isPlainObject(u)&&f.isPlainObject(d)?f.merge.call({caseless:g},u,d):f.isPlainObject(d)?f.merge({},d):f.isArray(d)?d.slice():d}function a(u,d,h,g){if(f.isUndefined(d)){if(!f.isUndefined(u))return n(void 0,u,h,g)}else return n(u,d,h,g)}function o(u,d){if(!f.isUndefined(d))return n(void 0,d)}function i(u,d){if(f.isUndefined(d)){if(!f.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,h){if(h in e)return n(u,d);if(h in s)return n(void 0,u)}const c={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(u,d,h)=>a(Tt(u),Tt(d),h,!0)};return f.forEach(Object.keys(Object.assign({},s,e)),function(d){const h=c[d]||a,g=h(s[d],e[d],d);f.isUndefined(g)&&h!==l||(r[d]=g)}),r}const kr=s=>{const e=ae({},s);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:o,headers:i,auth:l}=e;e.headers=i=W.from(i),e.url=gr(vr(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(f.isFormData(r)){if(U.hasStandardBrowserEnv||U.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[u,...d]=c?c.split(";").map(h=>h.trim()).filter(Boolean):[];i.setContentType([u||"multipart/form-data",...d].join("; "))}}if(U.hasStandardBrowserEnv&&(n&&f.isFunction(n)&&(n=n(e)),n||n!==!1&&ra(e.url))){const u=a&&o&&sa.read(o);u&&i.set(a,u)}return e},oa=typeof XMLHttpRequest<"u",ia=oa&&function(s){return new Promise(function(r,n){const a=kr(s);let o=a.data;const i=W.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=a,d,h,g,v,y;function m(){v&&v(),y&&y(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let x=new XMLHttpRequest;x.open(a.method.toUpperCase(),a.url,!0),x.timeout=a.timeout;function A(){if(!x)return;const j=W.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),k={data:!l||l==="text"||l==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:j,config:s,request:x};wr(function(E){r(E),m()},function(E){n(E),m()},k),x=null}"onloadend"in x?x.onloadend=A:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(A)},x.onabort=function(){x&&(n(new B("Request aborted",B.ECONNABORTED,s,x)),x=null)},x.onerror=function(){n(new B("Network Error",B.ERR_NETWORK,s,x)),x=null},x.ontimeout=function(){let N=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const k=a.transitional||xr;a.timeoutErrorMessage&&(N=a.timeoutErrorMessage),n(new B(N,k.clarifyTimeoutError?B.ETIMEDOUT:B.ECONNABORTED,s,x)),x=null},o===void 0&&i.setContentType(null),"setRequestHeader"in x&&f.forEach(i.toJSON(),function(N,k){x.setRequestHeader(k,N)}),f.isUndefined(a.withCredentials)||(x.withCredentials=!!a.withCredentials),l&&l!=="json"&&(x.responseType=a.responseType),u&&([g,y]=Ae(u,!0),x.addEventListener("progress",g)),c&&x.upload&&([h,v]=Ae(c),x.upload.addEventListener("progress",h),x.upload.addEventListener("loadend",v)),(a.cancelToken||a.signal)&&(d=j=>{x&&(n(!j||j.type?new de(null,s,x):j),x.abort(),x=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const F=Zn(a.url);if(F&&U.protocols.indexOf(F)===-1){n(new B("Unsupported protocol "+F+":",B.ERR_BAD_REQUEST,s));return}x.send(o||null)})},la=(s,e)=>{const{length:r}=s=s?s.filter(Boolean):[];if(e||r){let n=new AbortController,a;const o=function(u){if(!a){a=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof B?d:new de(d instanceof Error?d.message:d))}};let i=e&&setTimeout(()=>{i=null,o(new B(`timeout ${e} of ms exceeded`,B.ETIMEDOUT))},e);const l=()=>{s&&(i&&clearTimeout(i),i=null,s.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),s=null)};s.forEach(u=>u.addEventListener("abort",o));const{signal:c}=n;return c.unsubscribe=()=>f.asap(l),c}},ca=function*(s,e){let r=s.byteLength;if(r<e){yield s;return}let n=0,a;for(;n<r;)a=n+e,yield s.slice(n,a),n=a},da=async function*(s,e){for await(const r of ua(s))yield*ca(r,e)},ua=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:r,value:n}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},Lt=(s,e,r,n)=>{const a=da(s,e);let o=0,i,l=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}=await a.next();if(u){l(),c.close();return}let h=d.byteLength;if(r){let g=o+=h;r(g)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},Me=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",jr=Me&&typeof ReadableStream=="function",ha=Me&&(typeof TextEncoder=="function"?(s=>e=>s.encode(e))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),Nr=(s,...e)=>{try{return!!s(...e)}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");return!1}},ma=jr&&Nr(()=>{let s=!1;const e=new Request(U.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!e}),Ot=64*1024,Qe=jr&&Nr(()=>f.isReadableStream(new Response("").body)),Re={stream:Qe&&(s=>s.body)};Me&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Re[e]&&(Re[e]=f.isFunction(s[e])?r=>r[e]():(r,n)=>{throw new B(`Response type '${e}' is not supported`,B.ERR_NOT_SUPPORT,n)})})})(new Response);const fa=async s=>{if(s==null)return 0;if(f.isBlob(s))return s.size;if(f.isSpecCompliantForm(s))return(await new Request(U.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(f.isArrayBufferView(s)||f.isArrayBuffer(s))return s.byteLength;if(f.isURLSearchParams(s)&&(s=s+""),f.isString(s))return(await ha(s)).byteLength},pa=async(s,e)=>{const r=f.toFiniteNumber(s.getContentLength());return r??fa(e)},ga=Me&&(async s=>{let{url:e,method:r,data:n,signal:a,cancelToken:o,timeout:i,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:h="same-origin",fetchOptions:g}=kr(s);u=u?(u+"").toLowerCase():"text";let v=la([a,o&&o.toAbortSignal()],i),y;const m=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let x;try{if(c&&ma&&r!=="get"&&r!=="head"&&(x=await pa(d,n))!==0){let k=new Request(e,{method:"POST",body:n,duplex:"half"}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}),P;if(f.isFormData(n)&&(P=k.headers.get("content-type"))&&d.setContentType(P),k.body){const[E,w]=Et(x,Ae($t(c)));n=Lt(k.body,Ot,E,w)}}f.isString(h)||(h=h?"include":"omit");const A="credentials"in Request.prototype;y=new Request(e,{...g,signal:v,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:A?h:void 0});let F=await fetch(y,g);const j=Qe&&(u==="stream"||u==="response");if(Qe&&(l||j&&m)){const k={};["status","statusText","headers"].forEach(C=>{k[C]=F[C]});const P=f.toFiniteNumber(F.headers.get("content-length")),[E,w]=l&&Et(P,Ae($t(l),!0))||[];F=new Response(Lt(F.body,Ot,E,()=>{w&&w(),m&&m()}),k)}u=u||"text";let N=await Re[f.findKey(Re,u)||"text"](F,s);return!j&&m&&m(),await new Promise((k,P)=>{wr(k,P,{data:N,headers:W.from(F.headers),status:F.status,statusText:F.statusText,config:s,request:y})})}catch(A){throw m&&m(),A&&A.name==="TypeError"&&/Load failed|fetch/i.test(A.message)?Object.assign(new B("Network Error",B.ERR_NETWORK,s,y),{cause:A.cause||A}):B.from(A,A&&A.code,s,y)}}),Ze={http:Bn,xhr:ia,fetch:ga};f.forEach(Ze,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);})}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");}Object.defineProperty(s,"adapterName",{value:e})}});const It=s=>`- ${s}`,xa=s=>f.isFunction(s)||s===null||s===!1,Sr={getAdapter:s=>{s=f.isArray(s)?s:[s];const{length:e}=s;let r,n;const a={};for(let o=0;o<e;o++){r=s[o];let i;if(n=r,!xa(r)&&(n=Ze[(i=String(r)).toLowerCase()],n===void 0))throw new B(`Unknown adapter '${i}'`);if(n)break;a[i||"#"+o]=n}if(!n){const o=Object.entries(a).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=e?o.length>1?`since :
`+o.map(It).join(`
`):" "+It(o[0]):"as no adapter specified";throw new B("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:Ze};function We(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new de(null,s)}function Mt(s){return We(s),s.headers=W.from(s.headers),s.data=De.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),Sr.getAdapter(s.adapter||ye.adapter)(s).then(function(n){return We(s),n.data=De.call(s,s.transformResponse,n),n.headers=W.from(n.headers),n},function(n){return br(n)||(We(s),n&&n.response&&(n.response.data=De.call(s,s.transformResponse,n.response),n.response.headers=W.from(n.response.headers))),Promise.reject(n)})}const Cr="1.10.0",Ue={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{Ue[s]=function(n){return typeof n===s||"a"+(e<1?"n ":" ")+s}});const Ut={};Ue.transitional=function(e,r,n){function a(o,i){return"[Axios v"+Cr+"] Transitional option '"+o+"'"+i+(n?". "+n:"")}return(o,i,l)=>{if(e===!1)throw new B(a(i," has been removed"+(r?" in "+r:"")),B.ERR_DEPRECATED);return r&&!Ut[i]&&(Ut[i]=!0,console.warn(a(i," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(o,i,l):!0}};Ue.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function ya(s,e,r){if(typeof s!="object")throw new B("options must be an object",B.ERR_BAD_OPTION_VALUE);const n=Object.keys(s);let a=n.length;for(;a-- >0;){const o=n[a],i=e[o];if(i){const l=s[o],c=l===void 0||i(l,o,s);if(c!==!0)throw new B("option "+o+" must be "+c,B.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new B("Unknown option "+o,B.ERR_BAD_OPTION)}}const je={assertOptions:ya,validators:Ue},X=je.validators;let ne=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Pt,response:new Pt}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=ae(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:o}=r;n!==void 0&&je.assertOptions(n,{silentJSONParsing:X.transitional(X.boolean),forcedJSONParsing:X.transitional(X.boolean),clarifyTimeoutError:X.transitional(X.boolean)},!1),a!=null&&(f.isFunction(a)?r.paramsSerializer={serialize:a}:je.assertOptions(a,{encode:X.function,serialize:X.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),je.assertOptions(r,{baseUrl:X.spelling("baseURL"),withXsrfToken:X.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=o&&f.merge(o.common,o[r.method]);o&&f.forEach(["delete","get","head","post","put","patch","common"],y=>{delete o[y]}),r.headers=W.concat(i,o);const l=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(r)===!1||(c=c&&m.synchronous,l.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let d,h=0,g;if(!c){const y=[Mt.bind(this),void 0];for(y.unshift.apply(y,l),y.push.apply(y,u),g=y.length,d=Promise.resolve(r);h<g;)d=d.then(y[h++],y[h++]);return d}g=l.length;let v=r;for(h=0;h<g;){const y=l[h++],m=l[h++];try{v=y(v)}catch(x){m.call(this,x);break}}try{d=Mt.call(this,v)}catch(y){return Promise.reject(y)}for(h=0,g=u.length;h<g;)d=d.then(u[h++],u[h++]);return d}getUri(e){e=ae(this.defaults,e);const r=vr(e.baseURL,e.url,e.allowAbsoluteUrls);return gr(r,e.params,e.paramsSerializer)}};f.forEach(["delete","get","head","options"],function(e){ne.prototype[e]=function(r,n){return this.request(ae(n||{},{method:e,url:r,data:(n||{}).data}))}});f.forEach(["post","put","patch"],function(e){function r(n){return function(o,i,l){return this.request(ae(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}ne.prototype[e]=r(),ne.prototype[e+"Form"]=r(!0)});let ba=class Ar{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const n=this;this.promise.then(a=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](a);n._listeners=null}),this.promise.then=a=>{let o;const i=new Promise(l=>{n.subscribe(l),o=l}).then(a);return i.cancel=function(){n.unsubscribe(o)},i},e(function(o,i,l){n.reason||(n.reason=new de(o,i,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Ar(function(a){e=a}),cancel:e}}};function wa(s){return function(r){return s.apply(null,r)}}function va(s){return f.isObject(s)&&s.isAxiosError===!0}const et={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(et).forEach(([s,e])=>{et[e]=s});function Rr(s){const e=new ne(s),r=nr(ne.prototype.request,e);return f.extend(r,ne.prototype,e,{allOwnKeys:!0}),f.extend(r,e,null,{allOwnKeys:!0}),r.create=function(a){return Rr(ae(s,a))},r}const $=Rr(ye);$.Axios=ne;$.CanceledError=de;$.CancelToken=ba;$.isCancel=br;$.VERSION=Cr;$.toFormData=Ie;$.AxiosError=B;$.Cancel=$.CanceledError;$.all=function(e){return Promise.all(e)};$.spread=wa;$.isAxiosError=va;$.mergeConfig=ae;$.AxiosHeaders=W;$.formToJSON=s=>yr(f.isHTMLForm(s)?new FormData(s):s);$.getAdapter=Sr.getAdapter;$.HttpStatusCode=et;$.default=$;const{Axios:Ka,AxiosError:Ja,CanceledError:Xa,isCancel:Ya,CancelToken:Ga,VERSION:Qa,all:Za,Cancel:eo,isAxiosError:to,spread:ro,toFormData:so,AxiosHeaders:no,HttpStatusCode:ao,formToJSON:oo,getAdapter:io,mergeConfig:lo}=$;class ka{constructor(e){L(this,"baseUrl");L(this,"apiToken",null);L(this,"liquidityPool");this.baseUrl="https://api-proxy.ddpurse.com",this.liquidityPool=e}async getBestSwapRoute(e,r,n,a){if(!this.liquidityPool)return{route:"orderbook",quote:null};try{const o=await this.liquidityPool.getBestPriceRoute(e,r,BigInt(n),a);return{route:o.route,quote:o.quote,savings:o.savings}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}}catch(o){return console.error("Error getting best route:",o),{route:"orderbook",quote:null}}}async executeRoutedSwap(e,r,n,a,o){var i;try{const l=await this.getBestSwapRoute(e,r,n,o);if(this.liquidityPool&&l.route==="pool"){const c=await this.liquidityPool.executeRoutedSwap(e,r,BigInt(n),a,o);return{success:c.success,route:c.route,outputAmount:(i=c.outputAmount)==null?void 0:i.toString(),error:c.error}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}}else return{success:!1,route:"orderbook",error:"Orderbook integration pending"}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error"}}}async initializeApiToken(){try{const e=await $.get(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/swap-info`);this.apiToken=e.data.nonce}catch(e){throw console.error("Failed to initialize API token:",e),new Error("Failed to initialize swap service")}}async getAvailableTokens(e,r=200){try{const n="https://open-api-fractal.unisat.io";console.log("Fetching from:",`${n}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/v1/indexer/runes/info-list`);const a=e?500:r,o=100;let i=[];for(let c=0;c<a;c+=o)try{const u=await $.get(`${n}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/v1/indexer/runes/info-list`,{params:{start:c,limit:o},timeout:15e3,headers:{Accept:"application/json","Content-Type":"application/json"}});if(u.data.code===0&&u.data.data&&u.data.data.detail){const d=u.data.data.detail;if(i.push(...d),d.length<o)break;e&&d.some(h=>h.spacedRune.toLowerCase().includes(e.toLowerCase()))&&console.log(`Found target rune "${e}" in batch ${c}-${c+o}`)}else break}catch(u){console.warn(`Failed to fetch batch ${c}-${c+o}:`,u);break}console.log(`Fetched ${i.length} total tokens from UniSat API`);let l=i.map(c=>{var u;return{tick:c.spacedRune,name:c.spacedRune,symbol:c.symbol,decimals:c.divisibility,supply:c.supply,holders:c.holders,mintable:c.mintable,burned:c.burned,runeId:c.runeid||((u=c.number)==null?void 0:u.toString())||c.spacedRune,number:c.number}});if(console.log("Raw rune data sample:",i.slice(0,2)),console.log("Processed tokens sample:",l.slice(0,2)),e&&e.trim()){const c=e.toLowerCase().trim();l=l.filter(u=>u.tick.toLowerCase().includes(c)||u.name.toLowerCase().includes(c)||u.symbol&&u.symbol.toLowerCase().includes(c)),console.log(`Filtered to ${l.length} tokens matching "${e}"`)}return console.log("Final tokens:",l.length,l.slice(0,3)),l}catch(n){return console.error("Failed to fetch Runes from UniSat API:",n),n.response&&(console.error("Response status:",n.response.status),console.error("Response data:",n.response.data)),[]}}async searchRunes(e){return!e||e.trim().length<2?this.getAvailableTokens():this.getAvailableTokens(e)}async getSwapQuote(e,r,n,a=.5){try{const i=(await $.post(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/brc20swap/quote`,{from_token:e==="FB"?"BTC":e,to_token:r==="FB"?"BTC":r,amount:n,slippage:a})).data.data;return{fromToken:e==="FB"?"FB":{tick:e},toToken:r==="FB"?"FB":{tick:r},fromAmount:n,toAmount:i.to_amount,rate:i.rate,slippage:a,fee:i.fee,estimatedGas:i.gas_estimate}}catch(o){console.error("Traditional swap API failed, analyzing listings:",o);const i=await this.analyzeSwapOptions(e,r,n);if(i.bestOption&&i.bestOption.feasible){const c=parseFloat(i.bestOption.totalAmount)/parseFloat(i.bestOption.totalCost);return{fromToken:e==="FB"?"FB":{tick:e},toToken:r==="FB"?"FB":{tick:r},fromAmount:i.bestOption.totalCost,toAmount:i.bestOption.totalAmount,rate:c.toString(),slippage:a,fee:"0.0001",estimatedGas:"1000"}}const l=i.marketDepth.totalLiquidity;throw i.options.length,parseFloat(l)>0?new Error(`Insufficient liquidity for ${n} ${r}. Available: ${this.formatAmount(l)} ${r} across ${i.marketDepth.listingCount} listings. Try a smaller amount.`):new Error(`No marketplace listings found for ${r}. This token may not have active sellers on the Fractal Bitcoin marketplace yet. Prices are based on real user listings, not synthetic rates.`)}}async analyzeSwapOptions(e,r,n){const a=parseFloat(n),o=await this.getTokenListings(r);if(console.log(`Found ${o.length} listings for ${r}:`,o),o.length===0)return{requestedAmount:n,requestedToken:e,targetToken:r,options:[],alternativeAmounts:[],marketDepth:{totalLiquidity:"0",averagePrice:"0",priceRange:{min:"0",max:"0"},listingCount:0}};const i=o.sort((y,m)=>parseFloat(y.price)-parseFloat(m.price));console.log(`Sorted ${i.length} listings by price for ${r}`);const l=[];if(e==="FB"){console.log(`Calculating tokens available for ${a} FB`);const y=this.findAffordableCombination(i,a);y&&l.push(y);const m=this.suggestAlternativeFBAmounts(i,a);return{requestedAmount:n,requestedToken:e,targetToken:r,options:l.slice(0,6),bestOption:l[0],alternativeAmounts:m.slice(0,5),marketDepth:this.calculateMarketDepth(o)}}const c=i.find(y=>Math.abs(parseFloat(y.amount)-a)<.001);c&&(console.log(`Found exact match: ${c.amount} ${r}`),l.push({type:"exact",description:`Exact match: ${this.formatAmount(c.amount)} ${r}`,listings:[c],totalAmount:c.amount,totalCost:(parseFloat(c.amount)*parseFloat(c.price)).toString(),averagePrice:c.price,priceImpact:0,feasible:!0}));const u=i.filter(y=>parseFloat(y.amount)>a).slice(0,3);console.log(`Found ${u.length} partial options for ${a} ${r}`),u.forEach((y,m)=>{const x=a*parseFloat(y.price);console.log(`Partial option ${m+1}: Buy ${a} from ${y.amount} available at ${y.price}`),l.push({type:"partial",description:`Buy ${this.formatAmount(a.toString())} from ${this.formatAmount(y.amount)} available`,listings:[y],totalAmount:a.toString(),totalCost:x.toString(),averagePrice:y.price,priceImpact:0,feasible:!0,reason:`Seller has ${this.formatAmount(y.amount)} available, you can buy ${this.formatAmount(a.toString())}`})});const d=this.findBestCombination(i,a);d&&l.push(d);const h=this.suggestAlternativeAmounts(i,a);h.forEach(y=>{const m=parseFloat(y),x=this.findBestCombination(i,m);x&&l.push({...x,type:"alternative",description:`Alternative: ${this.formatAmount(y)} ${r} (${this.getAmountDifference(a,m)})`})});const g=l.length>0?l.reduce((y,m)=>{const x=parseFloat(y.averagePrice);return parseFloat(m.averagePrice)<x?m:y},l[0]):void 0,v=this.calculateMarketDepth(o);return{requestedAmount:n,requestedToken:e,targetToken:r,options:l.slice(0,6),bestOption:g,alternativeAmounts:h.slice(0,5),marketDepth:v}}async getTokenListings(e,r=100){try{console.log(`Fetching real marketplace listings for token: ${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);const n="https://open-api-fractal.unisat.io",o=(await this.getAvailableTokens(e,1)).find(l=>l.tick===e);if(!o)return console.log(`Token ${e} not found in available tokens`),[];console.log(`Found token ${e} with runeid: ${o.runeId}`);const i=[`/v1/indexer/runes/${o.runeId}/listings`,`/v1/market/runes/${o.runeId}/listings`,`/v1/indexer/runes/listings?runeId=${o.runeId}`,`/v1/indexer/runes/${encodeURIComponent(e)}/listings`];for(const l of i)try{console.log(`Trying endpoint: ${n}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}${l}`);const c=await $.get(`${n}${l}`,{params:{limit:r},timeout:1e4,headers:{Accept:"application/json","Content-Type":"application/json"}});if(c.data.code===0&&c.data.data&&Array.isArray(c.data.data)){const u=c.data.data.map(d=>({id:d.id||d.inscriptionId,tick:e,amount:d.amount,price:d.price||d.unitPrice,seller:d.seller||d.address,timestamp:d.timestamp,status:d.status||"active",batchSize:d.amount}));return console.log(`✅ Found ${u.length} real marketplace listings for ${e}`),console.log("Sample listing:",u[0]),u}}catch(c){console.log(`Endpoint ${l} failed:`,c.message);continue}return console.log(`❌ No marketplace listings found for ${e} on any endpoint`),[]}catch(n){return console.error(`Failed to fetch marketplace listings for ${e}:`,n),[]}}findAffordableCombination(e,r){let n=r,a=0;const o=[];for(const i of e){if(n<=0)break;const l=parseFloat(i.amount),c=parseFloat(i.price),u=l*c;if(u<=n)o.push(i),a+=l,n-=u;else{const d=n/c;if(d>0){const h={...i,amount:d.toString(),batchSize:i.amount};o.push(h),a+=d,n=0}}}if(a>0){const i=r-n,l=i/a;return{type:"multiple",description:`Buy ${this.formatAmount(a.toString())} tokens with ${this.formatAmount(i.toString())} FB`,listings:o,totalAmount:a.toString(),totalCost:i.toString(),averagePrice:l.toString(),priceImpact:this.calculateListingPriceImpact(o),feasible:!0}}return null}suggestAlternativeFBAmounts(e,r){const n=[];e.forEach(i=>{const l=parseFloat(i.amount)*parseFloat(i.price);l!==r&&l>0&&n.push(l)});const a=[.01,.05,.1,.2,.5,1].filter(i=>i!==r);return n.push(...a),[...new Set(n)].filter(i=>i>0).sort((i,l)=>Math.abs(i-r)-Math.abs(l-r)).slice(0,5).map(i=>i.toString())}findBestCombination(e,r){const n=[];let a=r,o=0;for(const l of e){if(a<=0)break;const c=parseFloat(l.amount),u=parseFloat(l.price);if(c<=a)n.push(l),a-=c,o+=c*u;else{const d={...l,amount:a.toString(),batchSize:l.amount};n.push(d),o+=a*u,a=0}}if(a>0){const l=r-a,c=l/r*100;return{type:"multiple",description:`Partial fulfillment: ${this.formatAmount(l.toString())} (${c.toFixed(1)}% of requested)`,listings:n,totalAmount:l.toString(),totalCost:o.toString(),averagePrice:(o/l).toString(),priceImpact:this.calculateListingPriceImpact(n),feasible:c>=80,reason:`${c.toFixed(1)}% of requested amount available in current listings`}}const i=o/r;return{type:"multiple",description:`Combine ${n.length} listing${n.length>1?"s":""}`,listings:n,totalAmount:r.toString(),totalCost:o.toString(),averagePrice:i.toString(),priceImpact:this.calculateListingPriceImpact(n),feasible:!0}}suggestAlternativeAmounts(e,r){const n=e.map(c=>parseFloat(c.amount)),a=[],o=r*.2;n.forEach(c=>{const u=Math.abs(c-r);u<=o&&u>0&&a.push(c)});const i=[Math.floor(r/1e3)*1e3,Math.ceil(r/1e3)*1e3,Math.floor(r/500)*500,Math.ceil(r/500)*500,Math.floor(r/100)*100,Math.ceil(r/100)*100].filter(c=>c>0&&c!==r);return a.push(...i),[...new Set(a)].sort((c,u)=>Math.abs(c-r)-Math.abs(u-r)).slice(0,5).map(c=>c.toString())}calculateListingPriceImpact(e){if(e.length<=1)return 0;const r=e.map(o=>parseFloat(o.price)),n=Math.min(...r);return(Math.max(...r)-n)/n*100}calculateMarketDepth(e){if(e.length===0)return{totalLiquidity:"0",averagePrice:"0",priceRange:{min:"0",max:"0"},listingCount:0};const r=e.reduce((o,i)=>o+parseFloat(i.amount),0),n=e.map(o=>parseFloat(o.price)),a=n.reduce((o,i)=>o+i,0)/n.length;return{totalLiquidity:r.toString(),averagePrice:a.toString(),priceRange:{min:Math.min(...n).toString(),max:Math.max(...n).toString()},listingCount:e.length}}getAmountDifference(e,r){const n=r-e,a=Math.abs(n)/e*100;return n>0?`+${a.toFixed(1)}% more`:`-${a.toFixed(1)}% less`}getMockQuote(e,r,n,a){const o=parseFloat(n),i={FB_to_rune:1e6,rune_to_FB:1e-6,rune_to_rune:1};let l,c;e==="FB"&&r!=="FB"?(l=i.FB_to_rune,c=o*l):e!=="FB"&&r==="FB"?(l=i.rune_to_FB,c=o*l):(l=i.rune_to_rune,c=o*l);const u=1-a/100;return c=c*u,{fromToken:e==="FB"?"FB":{tick:e},toToken:r==="FB"?"FB":{tick:r},fromAmount:n,toAmount:c.toString(),rate:l.toString(),slippage:a,fee:"0.0001",estimatedGas:"1000"}}async getSwapPSBT(e){this.apiToken||await this.initializeApiToken();try{const n=(await $.post(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/brc20swap/get_swap_psbt2`,{token:e.token==="FB"?"BTC":e.token,tick:e.tick==="FB"?"BTC":e.tick,address:e.address,amount:e.amount,slippage:e.slippage,fee_rate:e.feeRate},{headers:{Authorization:`Bearer ${this.apiToken}`,"Content-Type":"application/json"}})).data.data;return{psbt:n.psbt,nonce:n.nonce,expiresAt:Date.now()+"60000"}}catch(r){throw console.error("Failed to get PSBT:",r),new Error("Failed to create swap transaction")}}async submitSwapPSBT(e,r){try{const a=(await $.post(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/brc20swap/send_swap_psbt`,{psbt:e,nonce:r},{headers:{Authorization:`Bearer ${this.apiToken}`,"Content-Type":"application/json"}})).data.data;return{id:a.swap_id,hash:a.tx_hash,status:"pending",fromToken:a.from_token,toToken:a.to_token,fromAmount:a.from_amount,toAmount:a.to_amount,timestamp:Date.now(),confirmations:0}}catch(n){throw console.error("Failed to submit PSBT:",n),new Error("Failed to submit swap transaction")}}async getTransactionStatus(e){try{const n=(await $.get(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/brc20swap/status/${e}`)).data.data;return{id:e,hash:n.tx_hash,status:n.status,fromToken:n.from_token,toToken:n.to_token,fromAmount:n.from_amount,toAmount:n.to_amount,timestamp:n.timestamp,confirmations:n.confirmations||0,blockHeight:n.block_height}}catch(r){throw console.error("Failed to get transaction status:",r),new Error("Failed to get transaction status")}}async getSwapHistory(e){try{return((await $.get(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/brc20swap/history/${e}`)).data.data||[]).map(a=>({id:a.swap_id,hash:a.tx_hash,status:a.status,fromToken:a.from_token,toToken:a.to_token,fromAmount:a.from_amount,toAmount:a.to_amount,timestamp:a.timestamp,confirmations:a.confirmations||0,blockHeight:a.block_height}))}catch(r){return console.error("Failed to get swap history:",r),[]}}async getOptimalFeeRate(){try{return(await $.get(`${this.baseUrl}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/fee/estimate`)).data.data.medium||2}catch(e){return console.error("Failed to get fee rate:",e),2}}validateSwapParams(e,r,n,a){if(!e||!r)return{valid:!1,error:"Both tokens must be selected"};if(e===r)return{valid:!1,error:"Cannot swap the same token"};const o=parseFloat(n);return isNaN(o)||o<=0?{valid:!1,error:"Amount must be a positive number"}:a<0||a>50?{valid:!1,error:"Slippage must be between 0% and 50%"}:{valid:!0}}formatTokenAmount(e,r=8){const n=parseFloat(e);return isNaN(n)?"0":n.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:r})}formatAmount(e){const r=parseFloat(e);return r>=1e6?(r/1e6).toFixed(2)+"M":r>=1e3?(r/1e3).toFixed(2)+"K":r.toLocaleString()}calculatePriceImpact(e,r,n){const a=parseFloat(e),o=parseFloat(r),i=parseFloat(n);if(a===0||i===0)return 0;const l=o/a,c=(i-l)/i*100;return Math.abs(c)}async checkPriceDataAvailability(){var r;const e="https://open-api-fractal.unisat.io";console.log("🔍 Checking Fractal Bitcoin Mainnet Price Data Availability..."),console.log("Base URL:",e),console.log("⚠️  READ-ONLY CHECKS - No transactions will be made");try{console.log(`
📊 Checking general market endpoints...`);const n=["/v1/indexer/runes/market","/v1/market/runes","/v1/indexer/runes/listings"];for(const a of n)try{const o=await fetch(`${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}${a}`,{timeout:5e3,headers:{Accept:"application/json"}});if(o.ok){const i=await o.json();console.log(`✅ ${a} works:`,i)}else console.log(`❌ ${a} failed: ${o.status}`)}catch(o){console.log(`❌ ${a} error:`,o.message)}}catch(n){console.log("❌ General market check failed:",n.message)}try{console.log(`
🎯 Checking specific rune listings for price discovery...`);const n=await this.getAvailableTokens("",5);if(n.length>0)for(const a of n.slice(0,3)){console.log(`
🔍 Checking listings for ${a.tick}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}...`);const o=await this.checkRuneListings(a.runeId,a.tick);o.hasListings?(console.log(`✅ ${a.tick}: Found ${(r=o.listings)==null?void 0:r.length} listings`),console.log(`   Latest price: ${o.latestPrice} FB per token`)):console.log(`❌ ${a.tick}: No active listings found`)}}catch(n){console.log("❌ Failed to check rune listings:",n.message)}console.log(`
🏁 Price discovery check completed!`),console.log("💡 Real price discovery comes from active listings/orders, not market APIs")}async checkRuneListings(e,r){const n="https://open-api-fractal.unisat.io";console.log(`🔍 Checking listings for ${r} (ID: ${e})`);const a=[`/v1/indexer/runes/${e}/listings`,`/v1/indexer/runes/${e}/orders`,`/v1/indexer/runes/${e}/market-orders`,`/v1/market/runes/${e}/listings`,`/v1/market/runes/${e}/orders`,`/v1/indexer/runes/listings?runeId=${e}`,`/v1/indexer/runes/orders?runeId=${e}`,`/v1/indexer/runes/${r}/listings`,`/v1/indexer/runes/${r}/orders`];for(const o of a)try{console.log(`🔍 Testing listings: ${o}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);const i=await fetch(`${n}${o}`,{timeout:5e3,headers:{Accept:"application/json","Content-Type":"application/json"}});if(i.ok){const l=await i.json();if(console.log(`✅ Listings endpoint works: ${o}`),console.log("Listings data:",l),l.code===0&&l.data){const c=l.data.detail||l.data.list||l.data;if(Array.isArray(c)&&c.length>0){const u=c.filter(d=>d.price&&parseFloat(d.price)>0).map(d=>({price:parseFloat(d.price),amount:d.amount,seller:d.seller,timestamp:d.timestamp,listing:d})).sort((d,h)=>h.timestamp-d.timestamp);if(u.length>0){const d=u[0].price;return console.log(`✅ Found ${u.length} listings for ${r}`),console.log(`Latest price: ${d} FB per token`),{hasListings:!0,listings:u,latestPrice:d}}}}}}catch(i){console.log(`❌ ${o} failed:`,i.message);continue}return console.log(`❌ No listings found for ${r}`),{hasListings:!1}}async checkMarketOverview(){var r,n,a;const e="https://open-api-fractal.unisat.io";try{console.log("📊 Checking market overview availability...");const o=await $.get(`${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}/v1/indexer/runes/market`,{timeout:1e4,headers:{Accept:"application/json","Content-Type":"application/json"}});return o.data&&o.data.code===0?(console.log("✅ Market overview available:",o.data.data),{available:!0,data:o.data.data}):(console.log("❌ Market overview not available:",o.data),{available:!1})}catch(o){return console.log("❌ Market overview error:",(r=o.response)==null?void 0:r.status,((a=(n=o.response)==null?void 0:n.data)==null?void 0:a.message)||o.message),{available:!1}}}async getRuneInfo(e){var n,a;const r="https://open-api-fractal.unisat.io";try{console.log(`🔍 Fetching rune info for: ${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);const o=await $.get(`${r}/v1/indexer/runes/${e}/info`,{timeout:15e3,headers:{Accept:"application/json","Content-Type":"application/json"}});return o.data.code===0?(console.log(`✅ Rune info retrieved for ${e}:`,o.data.data),{success:!0,data:o.data.data}):(console.log(`❌ Failed to get rune info for ${e}:`,o.data.msg),{success:!1,data:{},error:o.data.msg||"Failed to fetch rune info"})}catch(o){return console.error(`❌ Error fetching rune info for ${e}:`,o.message),{success:!1,data:{},error:((a=(n=o.response)==null?void 0:n.data)==null?void 0:a.msg)||o.message||"Network error"}}}async getAddressRunes(e,r=0,n=16){var o,i;const a="https://open-api-fractal.unisat.io";try{console.log(`🔍 Fetching runes for address: ${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);const l=await $.get(`${a}/v1/indexer/address/${e}/runes`,{params:{start:r,limit:n},timeout:15e3,headers:{Accept:"application/json","Content-Type":"application/json"}});return l.data.code===0?(console.log(`✅ Address runes retrieved for ${e}:`,l.data.data),{success:!0,data:l.data.data}):(console.log(`❌ Failed to get address runes for ${e}:`,l.data.msg),{success:!1,data:{detail:[],total:0},error:l.data.msg||"Failed to fetch address runes"})}catch(l){return console.error(`❌ Error fetching address runes for ${e}:`,l.message),{success:!1,data:{detail:[],total:0},error:((i=(o=l.response)==null?void 0:o.data)==null?void 0:i.msg)||l.message||"Network error"}}}async getUserRuneTokens(e){try{console.log(`🔍 Getting user rune tokens for: ${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);const r=await this.getAddressRunes(e,0,100);if(r.success&&r.data.detail){const n=[];for(const a of r.data.detail)try{const o=await this.getRuneInfo(a.runeid);if(o.success){const i={tick:o.data.spacedRune||o.data.rune,name:o.data.spacedRune||o.data.rune,symbol:o.data.symbol||"",decimals:o.data.divisibility||0,supply:o.data.supply||"0",holders:parseInt(o.data.holders||"0"),mintable:o.data.mintable||!1,burned:o.data.burned||"0",runeId:o.data.runeid,number:parseInt(o.data.number||"0"),balance:a.amount}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);};n.push(i)}}catch(o){console.warn(`⚠️ Failed to get info for rune ${a.runeid}:`,o),n.push({tick:a.spacedRune||a.rune,name:a.spacedRune||a.rune,symbol:a.symbol||"",decimals:a.divisibility||0,supply:"0",holders:0,mintable:!1,burned:"0",runeId:a.runeid,balance:a.amount})}return console.log(`✅ Retrieved ${n.length} rune tokens for user`),{success:!0,data:n}}else return{success:!1,data:[],error:r.error||"Failed to fetch user runes"}}catch(r){return console.error("❌ Error getting user rune tokens:",r.message),{success:!1,data:[],error:r.message||"Network error"}}}async searchRunesByName(e){try{console.log(`🔍 Searching runes for: "${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}"`);const n=(await this.getAvailableTokens(e,200)).filter(a=>a.tick.toLowerCase().includes(e.toLowerCase())||a.name.toLowerCase().includes(e.toLowerCase())||a.symbol.toLowerCase().includes(e.toLowerCase()));return console.log(`✅ Found ${n.length} matching runes`),{success:!0,data:n}}catch(r){return console.error("❌ Error searching runes:",r.message),{success:!1,data:[],error:r.message||"Search failed"}}}convertRuneInfoToToken(e){return{tick:e.spacedRune||e.rune,name:e.spacedRune||e.rune,symbol:e.symbol||"",decimals:e.divisibility||0,supply:e.supply||"0",holders:parseInt(e.holders||"0"),mintable:e.mintable||!1,burned:ruueInfo.burned||"0",runeId:e.runeid,number:parseInt(e.number||"0")}}async getSafeUTXOsForPSBT(e){var n,a;const r="https://open-api-fractal.unisat.io";try{console.log("🛡️ Getting SAFE UTXOs for Fractal Bitcoin PSBT construction"),console.log(`📍 Address: ${e}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`),console.log("⚠️ CRITICAL: Using available-utxo-data endpoint to prevent asset burning!");const o=await $.get(`${r}/v1/indexer/address/${e}/available-utxo-data`,{timeout:15e3,headers:{Accept:"application/json","Content-Type":"application/json"}});if(o.data.code===0){const i=o.data.data.utxo||[];return console.log(`✅ Safe UTXOs retrieved: ${i.length}`),console.log(`📊 Total available satoshis: ${i.reduce((l,c)=>l+c.satoshi,0)}`),i.length>0&&(console.log("🔍 Sample safe UTXOs:"),i.slice(0,3).forEach((l,c)=>{console.log(`  ${c+1}. ${l.txid}:${l.vout} - ${l.satoshi} sats (inscriptions: ${l.inscriptionsCount})`)})),i.length===0?(console.warn("⚠️ WARNING: No safe UTXOs available for spending!"),{success:!1,data:[],error:"No safe UTXOs available - all UTXOs contain assets that would be burned"}):{success:!0,data:i}}else return console.error(`❌ Failed to get safe UTXOs: ${o.data.msg}`),{success:!1,data:[],error:o.data.msg||"Failed to fetch safe UTXOs"}}catch(o){return console.error("❌ Error fetching safe UTXOs:",o.message),{success:!1,data:[],error:((a=(n=o.response)==null?void 0:n.data)==null?void 0:a.msg)||o.message||"Network error"}}}async createSafePSBT(e){try{console.log("🛡️ Creating SAFE PSBT with mandatory asset protection..."),console.log(`📍 Request: ${e.amount}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);} ${e.token} from ${e.address}`);const r=await this.getSafeUTXOsForPSBT(e.address);if(!r.success)throw new Error(`Cannot create PSBT: ${r.error}`);if(r.data.length===0)throw new Error("Cannot create PSBT: No safe UTXOs available - all UTXOs contain assets!");const n=r.data.reduce((l,c)=>l+c.satoshi,0);console.log(`💰 Total safe balance: ${n} satoshis`);const a={...e,availableUtxos:r.data.map(l=>({txid:l.txid,vout:l.vout,value:l.satoshi,scriptPk:l.scriptPk}))},i=(await $.post(`${this.baseUrl}/brc20swap/psbt`,a)).data.data;return console.log("✅ Safe PSBT created successfully"),console.log(`🔒 PSBT expires at: ${new Date(Date.now()+"60000")}`),{psbt:i.psbt,nonce:i.nonce,expiresAt:Date.now()+"60000"}}catch(r){throw console.error("❌ Safe PSBT creation failed:",r.message),new Error(`Failed to create safe PSBT: ${r.message}`)}}async checkRunePriceData(e){try{console.log("🎯 Checking individual rune price data...");const r=await this.getAvailableTokens("",5);if(r.length===0){console.log("❌ No tokens available to check");return}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}for(const n of r.slice(0,3)){console.log(`
🔍 Checking listings for ${n.tick}...`),console.log(`🔍 Checking listings for ${n.tick} (ID: ${n.runeId})`);const a=[`/v1/indexer/runes/${n.runeId}/listings`,`/v1/indexer/runes/${n.runeId}/orders`,`/v1/indexer/runes/${n.runeId}/market-orders`,`/v1/market/runes/${n.runeId}/listings`,`/v1/market/runes/${n.runeId}/orders`,`/v1/indexer/runes/listings?runeId=${n.runeId}`,`/v1/indexer/runes/orders?runeId=${n.runeId}`,`/v1/indexer/runes/${encodeURIComponent(n.tick)}/listings`,`/v1/indexer/runes/${encodeURIComponent(n.tick)}/orders`];let o=!1;for(const i of a)try{console.log(`🔍 Testing listings: ${i}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`);const c=await $.get(`https://open-api-fractal.unisat.io${i}`,{timeout:1e4,headers:{Accept:"application/json","Content-Type":"application/json"}});if(c.data.code===0&&c.data.data){console.log(`✅ ${i} success:`,c.data.data),o=!0;break}else console.log(`❌ ${i} failed: ${c.data.msg||"No data"}`)}catch(l){console.log(`❌ ${i} failed: ${l.message}`)}o||(console.log(`❌ No listings found for ${n.tick}`),console.log(`❌ ${n.tick}: No active listings found`))}console.log(`
🏁 Price discovery check completed!`),console.log("💡 Real price discovery comes from active listings/orders, not market APIs")}catch(r){console.error("❌ Error during check:",r.message)}}}const ie=new ka,ja=({transactions:s,onTransactionUpdate:e})=>{const[r,n]=p.useState(!1);p.useEffect(()=>{const u=setInterval(async()=>{if(s.length!==0){n(!0);try{for(const d of s)if(d.status==="pending")try{const h=await ie.getTransactionStatus(d.id);h.status!==d.status&&e(h)}catch(h){console.error(`Failed to update transaction ${d.id}:`,h)}}finally{n(!1)}}},1e4);return()=>clearInterval(u)},[s,e]);const a=c=>{switch(c){case"pending":return t.jsx("div",{className:"w-4 h-4 border-2 border-yellow-300 border-t-yellow-600 rounded-full animate-spin"});case"confirmed":return t.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})});case"failed":return t.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})});default:return null}},o=c=>{switch(c){case"pending":return"Pending";case"confirmed":return"Confirmed";case"failed":return"Failed";default:return"Unknown"}},i=c=>new Date(c).toLocaleTimeString(),l=(c,u)=>{const d=parseFloat(c);return isNaN(d)?`0 ${u}`:u==="BTC"?`${d.toFixed(8)} BTC`:`${d.toLocaleString()} ${u}`};return s.length===0?t.jsxs("div",{className:"fractal-card",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Transaction Monitor"}),t.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[t.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),t.jsx("p",{children:"No active transactions"}),t.jsx("p",{className:"text-sm mt-1",children:"Your swap transactions will appear here"})]})]}):t.jsxs("div",{className:"fractal-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Transaction Monitor"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[r&&t.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-fractal-orange rounded-full animate-spin"}),t.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[s.length," active"]})]})]}),t.jsx("div",{className:"space-y-4",children:s.map(c=>t.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[a(c.status),t.jsx("span",{className:`text-sm font-medium ${c.status==="pending"?"tx-pending":c.status==="confirmed"?"tx-confirmed":"tx-failed"}`,children:o(c.status)})]}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:i(c.timestamp)})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"From:"}),t.jsx("span",{className:"font-mono",children:l(c.fromAmount,c.fromToken)})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"To:"}),t.jsx("span",{className:"font-mono",children:l(c.toAmount,c.toToken)})]}),c.confirmations>0&&t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Confirmations:"}),t.jsxs("span",{className:"font-mono",children:[c.confirmations,"/6"]})]})]}),c.hash&&t.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Transaction Hash:"}),t.jsxs("a",{href:`https://explorer-fractal-testnet.unisat.io/tx/${c.hash}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-fractal-orange hover:underline font-mono",children:[c.hash.slice(0,8),"...",c.hash.slice(-8)]})]})}),c.status==="pending"&&t.jsxs("div",{className:"mt-3",children:[t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:"bg-fractal-orange h-2 rounded-full animate-pulse",style:{width:"30%"}})}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Waiting for confirmation..."})]}),c.status==="confirmed"&&c.blockHeight&&t.jsxs("div",{className:"mt-3 flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-block-pulse"}),t.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Block #",c.blockHeight.toLocaleString()]})]})]},c.id))}),t.jsx("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400 text-center",children:"Updates automatically every 10 seconds"})]})},Na=()=>{const{account:s}=oe(),[e,r]=p.useState([]),[n,a]=p.useState(!0),[o,i]=p.useState(null);p.useEffect(()=>{(async()=>{if(s){a(!0),i(null);try{const h=await ie.getSwapHistory(s.address);r(h)}catch(h){i("Failed to load swap history"),console.error("Failed to load swap history:",h)}finally{a(!1)}}})()},[s]);const l=d=>{const h="px-2 py-1 rounded-full text-xs font-medium";switch(d){case"pending":return`${h} bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400`;case"confirmed":return`${h} bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400`;case"failed":return`${h} bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400`;default:return`${h} bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400`}},c=d=>{const h=new Date(d);return h.toLocaleDateString()+" "+h.toLocaleTimeString()},u=(d,h)=>{const g=parseFloat(d);return isNaN(g)?`0 ${h}`:h==="BTC"?`${g.toFixed(8)} BTC`:`${g.toLocaleString()} ${h}`};return n?t.jsxs("div",{className:"fractal-card",children:[t.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Swap History"}),t.jsx("div",{className:"space-y-4",children:[...Array(3)].map((d,h)=>t.jsx("div",{className:"animate-pulse",children:t.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-32"}),t.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-24"})]}),t.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-16"})]})},h))})]}):o?t.jsxs("div",{className:"fractal-card",children:[t.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Swap History"}),t.jsxs("div",{className:"text-center py-8",children:[t.jsx("svg",{className:"w-12 h-12 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("p",{className:"text-red-600 dark:text-red-400",children:o}),t.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-fractal-orange text-white rounded-lg hover:bg-opacity-90 transition-all",children:"Retry"})]})]}):e.length===0?t.jsxs("div",{className:"fractal-card",children:[t.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Swap History"}),t.jsxs("div",{className:"text-center py-12",children:[t.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No swap history"}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Your completed swaps will appear here"}),t.jsx("button",{onClick:()=>window.location.href="/swap",className:"fractal-button",children:"Make Your First Swap"})]})]}):t.jsxs("div",{className:"fractal-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h2",{className:"text-xl font-semibold",children:"Swap History"}),t.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.length," transaction",e.length!==1?"s":""]})]}),t.jsx("div",{className:"space-y-4",children:e.map(d=>t.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-fractal-orange transition-colors",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("svg",{className:"w-4 h-4 text-fractal-orange",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),t.jsxs("span",{className:"font-medium",children:[d.fromToken," → ",d.toToken]})]}),t.jsx("span",{className:l(d.status),children:d.status})]}),t.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:c(d.timestamp)})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"From"}),t.jsx("div",{className:"font-mono text-lg",children:u(d.fromAmount,d.fromToken)})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"To"}),t.jsx("div",{className:"font-mono text-lg",children:u(d.toAmount,d.toToken)})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[d.confirmations>0&&t.jsxs("span",{children:[d.confirmations," confirmation",d.confirmations!==1?"s":""]}),d.blockHeight&&t.jsxs("span",{children:["Block #",d.blockHeight.toLocaleString()]})]}),d.hash&&t.jsxs("a",{href:`https://explorer-fractal-testnet.unisat.io/tx/${d.hash}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-fractal-orange hover:underline text-sm",children:[t.jsx("span",{children:"View Transaction"}),t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]},d.id))}),e.length>=10&&t.jsx("div",{className:"mt-6 text-center",children:t.jsx("button",{className:"px-6 py-2 border border-gray-200 dark:border-gray-700 rounded-lg hover:border-fractal-orange transition-colors",children:"Load More"})})]})};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ca=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),_t=s=>{const e=Ca(s);return e.charAt(0).toUpperCase()+e.slice(1)},Fr=(...s)=>s.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),Aa=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ra={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=p.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:i,...l},c)=>p.createElement("svg",{ref:c,...Ra,width:e,height:e,stroke:s,strokeWidth:n?Number(r)*24/Number(e):r,className:Fr("lucide",a),...!o&&!Aa(l)&&{"aria-hidden":"true"},...l},[...i.map(([u,d])=>p.createElement(u,d)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=(s,e)=>{const r=p.forwardRef(({className:n,...a},o)=>p.createElement(Fa,{ref:o,iconNode:e,className:Fr(`lucide-${Sa(_t(s))}`,`lucide-${s}`,n),...a}));return r.displayName=_t(s),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]],Ba=be("bug",Pa);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],$a=be("circle-check-big",Ea);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],qt=be("copy",Ta);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Oa=be("external-link",La);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ma=be("mail",Ia),Ua=()=>{const{isConnected:s,account:e}=oe(),[r,n]=p.useState(!1),a="a92633695@gmail.com",o=h=>{const[g,v]=h.split("@");return`${"*".repeat(g.length)}@${v}`},i=h=>{if(!h||h.length<20)return h;const g=h.slice(0,10),v=h.slice(-10);return`${g}${"*".repeat(h.length-20)}${v}`},l="Bug Report - Fractal Bitcoin Swap Platform",c=`Hi Support Team,

I found an issue on the Fractal Bitcoin Swap Platform.

Connected Wallet: ${(e==null?void 0:e.address)||"Not connected"}
Platform URL: ${window.location.href}
Browser: ${navigator.userAgent}
Timestamp: ${new Date().toISOString()}

Issue Description:
[Please describe the issue you encountered]

Steps to Reproduce:
1. [Step 1]
2. [Step 2]
3. [Step 3]

Expected Behavior:
[What you expected to happen]

Actual Behavior:
[What actually happened]

Additional Information:
[Any other relevant details]

Best regards`,u=`mailto:${a}?subject=${encodeURIComponent(l)}&body=${encodeURIComponent(c)}`,d=async()=>{try{await navigator.clipboard.writeText(a),n(!0),setTimeout(()=>n(!1),2e3)}catch(h){console.error("Failed to copy email:",h)}};return t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border-l-4 border-red-500",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[t.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:t.jsx(Ba,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Found a bug? Squash it here! 🐛"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Report issues directly via email"})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Ma,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),t.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:"Contact our support team:"})]}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"font-mono text-lg text-blue-600 dark:text-blue-400",children:o(a)}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"(Privacy protected)"})]}),t.jsx("button",{onClick:d,className:"flex items-center space-x-1 px-3 py-1 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-md transition-colors",title:"Copy full email address",children:r?t.jsxs(t.Fragment,{children:[t.jsx($a,{className:"w-4 h-4 text-green-600"}),t.jsx("span",{className:"text-sm text-green-600",children:"Copied!"})]}):t.jsxs(t.Fragment,{children:[t.jsx(qt,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Copy"})]})})]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsxs("a",{href:u,className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center space-x-2",children:[t.jsx(Oa,{className:"w-4 h-4"}),t.jsx("span",{children:"Open Email Client"})]}),t.jsxs("button",{onClick:d,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center space-x-2",children:[t.jsx(qt,{className:"w-4 h-4"}),t.jsx("span",{children:"Copy Email Address"})]})]}),t.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-2",children:[t.jsx("p",{className:"font-medium",children:"How to report an issue:"}),t.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[t.jsx("li",{children:'Click "Open Email Client" to compose an email with pre-filled template (full email revealed)'}),t.jsx("li",{children:"Or copy the email address (full address copied) and compose manually in your preferred email app"}),t.jsx("li",{children:"Describe the issue, steps to reproduce, and expected behavior"}),t.jsx("li",{children:"Send the email and we'll get back to you soon!"})]}),t.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-2 mt-3",children:t.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:"🔒 Privacy Note: Email address is masked for security. Full address is only revealed when copying or composing emails."})})]}),s&&(e==null?void 0:e.address)&&t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),t.jsx("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Wallet Connected"})]}),t.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["Your wallet address will be included in the email template: ",i(e.address)]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"(Full address included in email composition only)"})]}),!s&&t.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),t.jsx("span",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Wallet Not Connected"})]}),t.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 mt-1",children:"Connect your wallet for better issue tracking and support"})]})]})]})})},we=()=>{const{isConnected:s,account:e}=oe(),[r,n]=p.useState("trade"),[a,o]=p.useState([]),[i,l]=p.useState(""),[c,u]=p.useState(!1),[d,h]=p.useState(null),[g,v]=p.useState(!1),[y,m]=p.useState(!1);p.useEffect(()=>{const j=N=>{console.error("Page error:",N),v(!0)};return window.addEventListener("error",j),()=>window.removeEventListener("error",j)},[]),p.useEffect(()=>{console.log("SwapPage render - isConnected:",s,"account:",e)},[s,e]),p.useEffect(()=>{(async()=>{if(!s||!(e!=null&&e.address)){m(!1);return}try{const N=localStorage.getItem(`lastReplyCheck_${e.address}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}`),k=Date.now();Math.random()>.7&&(!N||k-parseInt(N)>864e5)&&m(!0)}catch(N){console.error("Failed to check for replies:",N)}})()},[s,e==null?void 0:e.address]);const x=j=>{o(N=>N.map(k=>k.id===j.id?j:k).filter(k=>k.status==="pending"))};p.useEffect(()=>{if(d){const j=setTimeout(()=>h(null),5e3);return()=>clearTimeout(j)}},[d]);const A=async()=>{u(!0),l(`🔍 Checking Fractal Bitcoin Mainnet Price Data Availability...
⚠️  READ-ONLY CHECKS - No transactions will be made

`);const j=console.log,N=[];console.log=(...k)=>{const P=k.map(E=>typeof E=="object"?JSON.stringify(E,null,2):String(E)).join(" ");N.push(P),j(...k)};try{await ie.checkPriceDataAvailability();const k=await ie.checkMarketOverview();k.available?(N.push(`
📊 Market Overview: AVAILABLE`),N.push(JSON.stringify(k.data,null,2))):N.push(`
📊 Market Overview: NOT AVAILABLE`);const P=await ie.getAvailableTokens("",3);if(P.length>0){N.push(`
🎯 Checking individual rune price data...`);for(const E of P.slice(0,3)){const w=await ie.checkRunePriceData(E.runeId);w!=null&&w.hasPrice?(N.push(`✅ ${E.tick}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}: Price data AVAILABLE (from ${w.source})`),N.push(`   Data: ${JSON.stringify(w.data,null,2)}`)):N.push(`❌ ${E.tick}: No price data available`)}}N.push(`
🏁 ASSESSMENT:`),N.push("If no price endpoints are available above, we need to build our own internal liquidity system")}catch(k){N.push(`❌ Error during check: ${k.message}`)}console.log=j,l(N.join(`
`)),u(!1)},F=async()=>{if(!(e!=null&&e.address)){alert("Please connect your wallet first");return}u(!0),l(`🔧 Debugging Runes Balance API...

`);const j=console.log,N=[];console.log=(...k)=>{const P=k.map(E=>typeof E=="object"?JSON.stringify(E,null,2):String(E)).join(" ");N.push(P),j(...k)};try{const{walletService:k}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}=await Ds(async()=>{const{walletService:w}=await Promise.resolve().then(()=>$s);return{walletService:w}},void 0);await k.debugRunesBalanceAPI(e.address),N.push(`
🔄 Attempting to fetch Runes balances...`);const P=await k.getRunesBalances(e.address);N.push("Final balances result:",JSON.stringify(P,null,2)),Object.keys(P).some(w=>w.toLowerCase().includes("black")||w.toLowerCase().includes("myth"))?N.push("🎯 Found black•myth•sun•wu•kong in balances!"):N.push("❌ black•myth•sun•wu•kong not found in balances")}catch(k){N.push(`❌ Error during debug: ${k.message}`)}console.log=j,l(N.join(`
`)),u(!1)};return g?t.jsx("div",{className:"max-w-4xl mx-auto",children:t.jsxs("div",{className:"fractal-card text-center",children:[t.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-4",children:"Something went wrong"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"There was an error loading the trading interface."}),t.jsx("button",{onClick:()=>{v(!1),window.location.reload()},className:"bg-fractal-orange text-white px-4 py-2 rounded-lg hover:bg-orange-600",children:"Reload Page"})]})}):s?t.jsxs("div",{className:"max-w-6xl mx-auto",children:[d&&t.jsx("div",{className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg ${d.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{children:d.message}),t.jsx("button",{onClick:()=>h(null),className:"ml-2 text-white hover:text-gray-200",children:"×"})]})}),t.jsxs("div",{className:"mb-8 text-center",children:[t.jsx("h1",{className:"text-3xl font-bold gradient-text mb-2",children:"Fractal Bitcoin Trading Platform"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Smart Price Routing • AMM Pools & Orderbook • Batch Optimization"})]}),t.jsxs("div",{className:"flex justify-center space-x-4 mb-8",children:[t.jsx("button",{onClick:()=>n("trade"),className:`px-6 py-3 rounded-lg font-medium transition-all ${r==="trade"?"bg-blue-600 text-white":"text-gray-600 dark:text-gray-400 hover:text-blue-600"}`,children:"💱 Trade"}),t.jsx("button",{onClick:()=>n("liquidity"),className:`px-6 py-3 rounded-lg font-medium transition-all ${r==="liquidity"?"bg-green-600 text-white":"text-gray-600 dark:text-gray-400 hover:text-green-600"}`,children:"💧 Provide liquidity"}),t.jsx("button",{onClick:()=>n("history"),className:`px-6 py-3 rounded-lg font-medium transition-all ${r==="history"?"bg-fractal-orange text-white":"text-gray-600 dark:text-gray-400 hover:text-fractal-orange"}`,children:"📊 My Orders"}),t.jsxs("button",{onClick:()=>{n("support"),m(!1),e!=null&&e.address&&localStorage.setItem(`lastReplyCheck_${e.address}`,Date.now().toString())},className:`px-6 py-3 rounded-lg font-medium transition-all relative ${r==="support"?"bg-red-600 text-white":"text-gray-600 dark:text-gray-400 hover:text-red-600"}`,children:["🐛 Support",y&&t.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),y&&t.jsx("span",{className:"absolute -top-2 -right-2 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:"1"})]})]}),t.jsxs("div",{className:"max-w-4xl mx-auto",children:[r==="trade"&&t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsx(Ws,{})}),t.jsx("div",{children:t.jsx(ja,{transactions:a,onTransactionUpdate:x})})]}),r==="liquidity"&&t.jsx(zs,{}),r==="history"&&t.jsx(Na,{}),r==="support"&&t.jsx(Ua,{})]}),t.jsxs("div",{className:"mt-12 max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"fractal-card cursor-pointer hover:shadow-lg transition-shadow duration-200 border-2 border-transparent hover:border-red-200 dark:hover:border-red-800",onClick:()=>n("support"),children:[t.jsxs("h3",{className:"font-semibold mb-2 flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Found a bug? Squash it here.",t.jsx("svg",{className:"w-4 h-4 text-red-600 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Help us improve the platform by reporting issues. Click here to submit bug reports and feature requests."}),t.jsx("div",{className:"mt-3 text-xs text-red-600 dark:text-red-400 font-medium",children:"Click to open issue reporter →"})]}),t.jsxs("div",{className:"fractal-card",children:[t.jsxs("h3",{className:"font-semibold mb-2 flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 text-fractal-orange mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Smart Batch Splitting"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Batches are split on-demand during trades. Remainder is auto-relisted to maintain liquidity."})]}),t.jsxs("div",{className:"fractal-card",children:[t.jsxs("h3",{className:"font-semibold mb-2 flex items-center",children:[t.jsx("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Fee Optimization"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Get discounts for buying full batches. Smart suggestions help you save on transaction fees."})]})]})]}):t.jsx("div",{className:"max-w-4xl mx-auto",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"w-16 h-16 bg-fractal-gradient rounded-full flex items-center justify-center mx-auto mb-6",children:t.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),t.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Connect Your Wallet"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8 max-w-md mx-auto",children:"To start swapping Runes tokens and FB on Fractal Bitcoin, please connect your wallet using the button in the header."}),t.jsxs("div",{className:"fractal-card max-w-md mx-auto",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Supported Wallets"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center border border-gray-200 dark:border-gray-700",children:t.jsx("img",{src:"unisat-logo.png",alt:"UniSat Wallet",className:"w-6 h-6 object-contain",onError:j=>{console.log("UniSat logo failed to load"),j.currentTarget.style.display="none"}})}),t.jsx("span",{children:"UniSat Wallet"})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center border border-gray-200 dark:border-gray-700",children:t.jsx("img",{src:"okx-logo.png",alt:"OKX Wallet",className:"w-6 h-6 object-contain",onError:j=>{console.log("OKX logo failed to load"),j.currentTarget.style.display="none"}})}),t.jsx("span",{children:"OKX Wallet"})]})]})]}),t.jsxs("div",{className:"fractal-card max-w-2xl mx-auto mt-8",children:[t.jsx("h3",{className:"font-semibold mb-4 text-fractal-orange",children:"🔍 Fractal Bitcoin Mainnet API Testing"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Check price discovery APIs and debug Runes balance fetching"}),t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsx("button",{onClick:A,disabled:c,className:"bg-fractal-orange text-white px-4 py-2 rounded-lg hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"🔄 Checking...":"🔍 Check Price APIs"}),t.jsx("button",{onClick:F,disabled:c,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"🔄 Debugging...":"🔧 Debug Runes Balances"})]}),i&&t.jsxs("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg text-left",children:[t.jsx("h4",{className:"font-semibold mb-2",children:"API Test Results:"}),t.jsx("pre",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap overflow-auto max-h-96",children:i})]})]})]})})};let tt=null,rt=null,st=null;try{tt=require("./components/DebugPanel").default}catch(s){console.warn("⚠️ DebugPanel not available:",s.message)}try{rt=require("./components/NotificationSystem").default}catch(s){console.warn("⚠️ NotificationSystem not available:",s.message)}try{st=require("./components/SecurityVerificationBadge").default}catch(s){console.warn("⚠️ SecurityVerificationBadge not available:",s.message)}let nt=null,at=null,pe=null;try{nt=require("./services/pageIntegrityService").default}catch(s){console.warn("⚠️ PageIntegrityService not available:",s.message)}try{at=require("./services/securityMonitorService").default}catch(s){console.warn("⚠️ SecurityMonitorService not available:",s.message)}try{const{defaultLiquidityPool:s}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);}=require("./services/liquidityPoolOrchestrator");pe=s}catch(s){console.warn("⚠️ Liquidity Pool initialization deferred:",s.message)}const _a=()=>{const[s,e]=p.useState(!0),[r,n]=p.useState(!1),[a,o]=p.useState(null);let i=[],l=()=>{};try{const c=Ls();i=c.notifications,l=c.removeNotification}catch(error){console.log("[TRACE] catch block in index-DJ07tDoB.js");console.warn("⚠️ Notification context not available")}return p.useEffect(()=>{(async()=>{var u,d;try{console.log("🔄 Starting Fractal Bitcoin Swap Platform...");const h=setTimeout(()=>{console.warn("⚠️ Initialization taking too long, proceeding anyway..."),e(!1)}catch(error){console.log("[TRACE] auto-added catch in index-DJ07tDoB.js", error);},1e4);if(nt)try{console.log("🔐 Initializing Security Services..."),await nt.getInstance().initialize(),console.log("✅ Page integrity initialized")}catch(g){console.warn("⚠️ Page integrity initialization failed:",g)}if(at)try{at.getInstance().startMonitoring(),console.log("✅ Security monitoring started")}catch(g){console.warn("⚠️ Security monitoring failed:",g)}if(n(!0),pe)try{console.log("🔄 Initializing AMM Liquidity Provision...");const g=((d=(u=pe.getAllAMMPools)==null?void 0:u.call(pe))==null?void 0:d.length)||0;console.log("📊 Available AMM Pools:",g)}catch(g){console.warn("⚠️ Liquidity pool initialization failed:",g)}clearTimeout(h),setTimeout(()=>{console.log("✅ Platform ready!"),e(!1)},1e3)}catch(h){console.error("❌ App initialization error:",h),o(h instanceof Error?h.message:"Unknown initialization error"),e(!1)}})()},[]),a?t.jsx("div",{className:"min-h-screen bg-red-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Initialization Error"}),t.jsx("p",{className:"text-red-500 mb-4",children:a}),t.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700",children:"Reload Page"})]})}):s?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),t.jsx("p",{className:"font-mono text-gray-600 text-lg",children:"Initializing Fractal Bitcoin Swap Platform..."}),r&&t.jsx("p",{className:"font-mono text-green-600 text-sm mt-2",children:"🔐 Security verification complete"})]})}):t.jsxs(t.Fragment,{children:[st&&t.jsx("div",{className:"fixed top-4 right-4 z-50",children:t.jsx(st,{showDetails:!1})}),t.jsxs(Fs,{basename:"/swap",children:[t.jsx(Us,{children:t.jsxs(Cs,{children:[t.jsx(fe,{path:"/",element:t.jsx(we,{})}),t.jsx(fe,{path:"/swap",element:t.jsx(we,{})}),t.jsx(fe,{path:"/c",element:t.jsx(we,{})}),t.jsx(fe,{path:"*",element:t.jsx(we,{})})]})}),tt&&t.jsx(tt,{})]}),rt&&t.jsx(rt,{notifications:i,onRemove:l})]})};function qa(){return t.jsx(kt,{fallback:t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50",children:t.jsxs("div",{className:"text-center p-responsive",children:[t.jsxs("div",{className:"flex items-center justify-center mb-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden mr-3",children:t.jsx("img",{src:"fbr.png",alt:"Fractal Bitcoin Runes",className:"w-full h-full object-contain"})}),t.jsx("h1",{className:"text-responsive-lg font-bold text-red-600",children:"Application Error"})]}),t.jsx("p",{className:"text-responsive-sm text-red-500 mb-4",children:"The application encountered an unexpected error."}),t.jsx("button",{onClick:()=>window.location.reload(),className:"fractal-button touch-button",children:"Reload Application"})]})}),children:t.jsx(Ps,{children:t.jsx(Bs,{children:t.jsx(Ts,{children:t.jsx(Os,{children:t.jsx(kt,{children:t.jsx(_a,{})})})})})})})}window.Buffer=Lr.Buffer;ze.createRoot(document.getElementById("root")).render(t.jsx(Tr.StrictMode,{children:t.jsx(qa,{})}));
